<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.60856f0f2ed73fb3cd2820ee548c4698ffbc4d743736e852c0e27ce4f52dfd9c.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  

<meta property="og:url" content="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/">
<meta property="og:title" content="Converting OGG To MP3">
<meta name="twitter:title" content="Converting OGG To MP3">


  <meta name="twitter:site" content="@brianwisti">



  
    <meta name="twitter:description" content="I have ignored my MacBook Pro for a few months. Now my iTunes and Rhythmbox music libraries are out of sync. The Rhythmbox library includes a handful of Ogg Vorbis files. Because iTunes does not support Ogg by default, I will use FFmpeg to convert those files to MP3. For the sake of novelty, card/Raku is the glue language for the task.
I know. I could go digging in the box at the bottom of the back of the closet and re-rip those CDs.">
    <meta property="og:description" content="I have ignored my MacBook Pro for a few months. Now my iTunes and Rhythmbox music libraries are out of sync. The Rhythmbox library includes a handful of Ogg Vorbis files. Because iTunes does not support Ogg by default, I will use FFmpeg to convert those files to MP3. For the sake of novelty, card/Raku is the glue language for the task.
I know. I could go digging in the box at the bottom of the back of the closet and re-rip those CDs.">
  



<title itemprop="name">Converting OGG To MP3 - Random Geekery</title>
<meta property="og:title" content=Converting&#32;OGG&#32;To&#32;MP3&#32;-&#32;Random&#32;Geekery />
<meta name="twitter:title" content=Converting&#32;OGG&#32;To&#32;MP3&#32;-&#32;Random&#32;Geekery />
<meta itemprop="name" content=Converting&#32;OGG&#32;To&#32;MP3&#32;-&#32;Random&#32;Geekery />
<meta name="application-name" content=Converting&#32;OGG&#32;To&#32;MP3&#32;-&#32;Random&#32;Geekery />
<meta property="og:site_name" content="Random Geekery" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/" />
<link rel="canonical" href="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/" itemprop="url" />
<meta name="url" content="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/" />
<meta name="twitter:url" content="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/" />
<meta property="og:url" content="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/" />


<meta property="og:updated_time" content=25002-25-12T20:00:17-0800 />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://randomgeekery.org/sitemap.xml' />

  <link
      rel="alternate"
      type="application/rss+xml"
    
        href="/index.xml"
    
      title="Random Geekery"/>



<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="" />
<meta name="twitter:creator" content="" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="Random Geekery" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.121.2">


    
    

<link
    rel="stylesheet"
    href="/css/style.fe9735814e6394fb590ff4fd2eb036a13152e6808ad90dd06ba181d89087b5d3.css"
    integrity="sha256-/pc1gU5jlPtZD/T9LrA2oTFS5oCK2Q3Qa6GB2JCHtdM=" 
    crossorigin="anonymous">


</head>

    <body class="">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
        
            <a href="https://randomgeekery.org">
                <h1>Random Geekery</h1>
            </a>
        
    </h1>
    <p class="lead">
    Collecting my attempts to improve at tech, art, and life
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">
      
        <li class="bullet">
          <a href="/follow/">Follow</a>
        </li>
      
        <li class="bullet">
          <a href="/now/">Now</a>
        </li>
      
    </ul>
</nav>

        
  <div class="related">
    <div class="related-posts">
      <h3>Related</h3>
      <ul>
        
          <li><a href="/post/2017/04/making-a-mojo-link-checker/">Making A Mojo Link Checker</a></li>
        
          <li><a href="/post/2021/05/my-raku-script-for-journaling-in-joplin/">My Raku script for Journaling in Joplin</a></li>
        
          <li><a href="/post/2020/07/tangling-code-from-hugo-content-with-raku/">Tangling code from Hugo content with Raku</a></li>
        
          <li><a href="/post/2020/03/listing-hugo-content-extensions-with-raku/">Listing Hugo Content Extensions With Raku</a></li>
        
          <li><a href="/post/2019/12/dwim-is-consistent/">DWIM is consistent</a></li>
        
      </ul>
    </div>
  </div>



        
















        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 Brian Wisti. All rights reserved.
</p>
<p class="footnote">
  This work is licensed under a
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License
  </a>.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <nav class="masthead">
    <ul>
    
  
    
  
    
  
    
  

    <li><a href="https://randomgeekery.org/">Random Geekery</a></li>
  

    <li><a href="https://randomgeekery.org/post/">Posts</a></li>
  

    <li><a href="https://randomgeekery.org/post/2017/">2017</a></li>
  

    <li><a class="active" href="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/">Converting OGG To MP3</a></li>
</nav>



  <div class="info">
    <h1 class="post-title">
        <a href="https://randomgeekery.org/post/2017/02/converting-ogg-to-mp3/">Converting OGG To MP3</a>
    </h1>
    
        <time datetime="2017-02-25T00:00:00-0800" class="post-date">
            February 25, 2017
        </time>
    
    
    <ul class="tags">
        
        <li class="tag-perl">
            <a href="https://randomgeekery.org/tags/perl">perl</a>
        </li>
        
        <li class="tag-raku-lang">
            <a href="https://randomgeekery.org/tags/raku-lang">raku-lang</a>
        </li>
        
        <li class="tag-perl-6">
            <a href="https://randomgeekery.org/tags/perl-6">perl-6</a>
        </li>
        
        <li class="tag-music">
            <a href="https://randomgeekery.org/tags/music">music</a>
        </li>
        
        <li class="tag-programming">
            <a href="https://randomgeekery.org/tags/programming">programming</a>
        </li>
        
    </ul>
    
    
    
    
    
    
</div>

  <p>I have ignored my MacBook Pro for a few months. Now my iTunes and   Rhythmbox music libraries are out of sync. The Rhythmbox library includes a handful of <a href="http://vorbis.com/">Ogg Vorbis</a> files. Because iTunes does not support Ogg by default, I will use <a href="http://ffmpeg.org/">FFmpeg</a> to convert those files to MP3. For the sake of novelty, <a href="/card/raku/">card/Raku</a> is the glue language for the task.</p>
<p>I know. I could go digging in the box at the bottom of the back of the closet
and re-rip those CDs. But the closet is all the way over there. I’m right here. I
don’t feel like getting up, and I do feel like using Perl 6 for something.</p>
<p>Don’t you judge me.</p>
<p>This is a quick journey into Raku for my own amusement, and not a tutorial. I linger on the stuff that caught my attention rather than explain all the details. Still &ndash; hopefully it’s useful to you!</p>
<h2 id="perl-6-star-notes">Perl 6 Star Notes</h2>
<p>I installed <a href="http://rakudo.org/downloads/star/">Rakudo Star</a> 2017.01 from source. Some of this information may be useful to others poking at a new <a href="http://rakudo.org/">Rakudo</a> installation.</p>
<h3 id="did-i-set-up-my-path-correctly">Did I Set Up My Path Correctly?</h3>
<p>I misread the path setup instructions after <code>make</code> finished, and ended up flailing in confusion for several minutes before I double-checked the Makefile. You can skip the flailing by reading correctly or by rerunning the &ldquo;welcome message.&rdquo;</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ make welcome-message

Rakudo Star has been built and installed successfully.
Please make sure that the following directories are in PATH:
  /home/random/src/rakudo-star-2017.01/install/bin
  /home/random/src/rakudo-star-2017.01/install/share/perl6/site/bin</code></pre>
</figure><h3 id="what-version-of-perl-6-do-i-have">What Version Of Perl 6 Do I Have?</h3>
<p>Just throwing it in so you can see what I’m working with.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ perl6 --version
This is Rakudo version 2017.01 built on MoarVM version 2017.01
implementing Perl 6.c.</code></pre>
</figure><h3 id="what-modules-do-i-have">What Modules Do I Have?</h3>
<p>As of version 2017.01, Rakudo includes <a href="https://github.com/ugexe/zef">zef</a> as its default package manager. See its <a href="https://github.com/ugexe/zef#usage">usage summary</a> for details of finding and installing modules. For the moment I want to know what came with my Rakudo Star installation.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ zef list --installed
===&gt; Found via /home/random/src/rakudo-star-2017.01/install/share/perl6
CORE:ver(&#39;6.c&#39;):auth(&#39;perl&#39;)
===&gt; Found via /home/random/src/rakudo-star-2017.01/install/share/perl6/site
Test::Mock:ver(&#39;1.3&#39;)
LWP::Simple:ver(&#39;0.090&#39;):auth(&#39;Cosimo Streppone&#39;)
Pod::To::HTML:ver(&#39;0.3.7&#39;)
panda:ver(&#39;2016.02&#39;)
NativeHelpers::Blob:ver(&#39;0.1.10&#39;):auth(&#39;github:salortiz&#39;)
SVG
JSON::Tiny
Grammar::Debugger
zef:auth(&#39;github:ugexe&#39;)
HTTP::Easy:ver(&#39;1.1.0&#39;)
XML::Writer
Template::Mojo:ver(&#39;0.1&#39;)
File::Which
File::Temp
File::Directory::Tree:auth(&#39;labster&#39;)
TAP::Harness::Prove6:ver(&#39;0.0.1&#39;):auth(&#39;Leon Timmermans&#39;)
Terminal::ANSIColor:ver(&#39;0.2&#39;)
DBIish:ver(&#39;0.5.9&#39;)
SVG::Plot
Template::Mustache:auth(&#39;github:softmoth&#39;)
File::Find:ver(&#39;0.1&#39;)
Debugger::UI::CommandLine
Grammar::Profiler::Simple:ver(&#39;0.01&#39;):auth(&#39;Jonathan Scott Duff&#39;)
Pod::To::BigPage:ver(&#39;0.2.1&#39;):auth(&#39;Wenzel P. P. Peppmeyer&#39;)
PSGI:ver(&#39;1.2.0&#39;)
p6doc
HTTP::Status
Linenoise:ver(&#39;0.1.1&#39;):auth(&#39;Rob Hoelz&#39;)
JSON::Fast:ver(&#39;0.7&#39;)
Native::Resources:ver(&#39;0.1.0&#39;):auth(&#39;Rob Hoelz&#39;)
Shell::Command
LibraryMake:ver(&#39;1.0.0&#39;):auth(&#39;github:retupmoca&#39;)
MIME::Base64:ver(&#39;1.2&#39;):auth(&#39;github:retupmoca&#39;)
Digest::MD5:ver(&#39;0.05&#39;):auth(&#39;Cosimo Streppone&#39;)
URI:ver(&#39;0.1.2&#39;)
JSON::RPC:ver(&#39;0.17.1&#39;):auth(&#39;Pawel Pabian&#39;)</code></pre>
</figure><p>It would be nice if the output had a sort option. I can sort myself, though I’d lose information about where the modules were found.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ zef list --installed | sort</code></pre>
</figure><p>I’m sure pull requests are welcome.</p>
<h3 id="how-do-i-get-at-the-documentation">How Do I Get At The Documentation?</h3>
<p>Once you stop flailing with your setup and know what modules are installed, use <a href="https://github.com/perl6/doc">p6doc</a> to read module documentation.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ p6doc File::Find</code></pre>
</figure><p>Okay I have my Rakudo Star installation sorted out. Time for the task at hand.</p>
<h2 id="quick-question-how-many">Quick question: How many?</h2>
<p>How many Ogg files do I have, anyways?</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ find ~/Music/ -name &#39;*.ogg&#39; | wc -l
212</code></pre>
</figure><p>More than a handful, but still - that’s not too bad. Let’s take a minute to look at the Perl 6 I used.</p>
<h3 id="count-the-files-from-perl-6">Count The Files From Perl 6</h3>
<p>In order to get a feel for what I’m doing in Perl 6, I’m going to use Perl 6 to count the Ogg files. This task relies on <a href="https://github.com/tadzik/File-Find">File::Find</a>, which comes with Rakudo Star. Perl 6 File::Find works like Perl 5’s <a href="https://metacpan.org/pod/File::Find::Rule">File::Find::Rule</a>. You describe characteristics of the files you’re looking for, and it hands you back a <a href="https://docs.perl6.org/language/list.html#Lazy_Lists">lazy list</a> of files that match.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">use</span> <span class="k">v</span><span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">File::Find</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$music_dir</span> <span class="o">=</span> <span class="vg">%*ENV</span><span class="p">&lt;</span><span class="s">HOME</span><span class="p">&gt;</span> <span class="o">~</span> <span class="p">&#34;</span><span class="s2">/Music</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@ogg_files</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s">dir</span>  <span class="o">=&gt;</span> <span class="nv">$music_dir</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">name</span> <span class="o">=&gt;</span> <span class="p">/</span><span class="se">\</span><span class="sr">.ogg</span><span class="ni">$</span><span class="p">/</span><span class="o">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$count</span> <span class="o">=</span> <span class="nv">@ogg_files</span><span class="o">.</span><span class="nb">elems</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">I see </span><span class="nv">$count</span><span class="s2"> Ogg files</span><span class="p">&#34;;</span></span></span></code></pre>
</figure><p>This does the same as the one-liner: look in <code>$HOME/Music</code> for and files suffixed with <code>.ogg</code>, and tell me how many matches it found.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ perl6 ogg-to-mp3.p6
I see 212 Ogg files</code></pre>
</figure><p>Yay I get exactly the same number of files that <code>find</code> found! Okay now I’m going to convert them to MP3. I’ll put them in a working directory so that I don’t confuse Rhythmbox.</p>
<p>FFmpeg can handle conversion, but my string starts looking a bit funky thanks to funky Perl quoting rules. Anyways.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">use</span> <span class="k">v</span><span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">File::Find</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">Audio::Taglib::Simple</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">$music_dir</span> <span class="o">=</span> <span class="vg">%*ENV</span><span class="p">&lt;</span><span class="s">HOME</span><span class="p">&gt;</span> <span class="o">~</span> <span class="p">&#34;</span><span class="s2">/Music</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="k">my</span> <span class="nv">@ogg_files</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="s">dir</span>  <span class="o">=&gt;</span> <span class="nv">$music_dir</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">  <span class="s">name</span> <span class="o">=&gt;</span> <span class="p">/</span><span class="se">\</span><span class="sr">.ogg</span><span class="ni">$</span><span class="p">/</span><span class="o">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nv">@ogg_files</span> <span class="k">-&gt;</span> <span class="nv">$ogg_file</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">my</span> <span class="nv">$path</span> <span class="o">=</span> <span class="kt">IO::Path</span><span class="o">.</span><span class="nb">new</span><span class="p">(</span><span class="nv">$ogg_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Where will the converted file go?</span>
</span></span><span class="line"><span class="cl">  <span class="k">my</span> <span class="nv">$working_dir</span> <span class="o">=</span> <span class="p">&#34;</span><span class="s2">converted</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">my</span> <span class="nv">$new_dir</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nb">dirname</span><span class="o">.</span><span class="nb">subst</span><span class="p">(</span><span class="nv">$music_dir</span><span class="o">,</span> <span class="nv">$working_dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">my</span> <span class="nv">$new_file</span> <span class="o">=</span> <span class="nv">$path</span><span class="o">.</span><span class="nb">basename</span><span class="o">.</span><span class="nb">subst</span><span class="p">(</span><span class="nv">$path</span><span class="o">.</span><span class="nb">extension</span><span class="o">,</span> <span class="p">&#34;</span><span class="s2">mp3</span><span class="p">&#34;);</span>
</span></span><span class="line"><span class="cl">  <span class="k">my</span> <span class="nv">$mp3_file</span> <span class="o">=</span> <span class="p">&#34;</span><span class="nv">$new_dir</span><span class="s2">/</span><span class="nv">$new_file</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Create the directory path if needed</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># (still returns True if $new_dir already exists)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">mkdir</span> <span class="nv">$new_dir</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Ask ffmpeg to convert.</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#   -y                    &lt;- overwrite if $mp3_file exists</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#   -v warning            &lt;- report warnings &amp; errors but not general info</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#   -i &#34;$ogg_file&#34;        &lt;- Read from here (quoted for spaces)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#   -map_metadata &#34;0:s:0&#34; &lt;- include title, artist, etc (quoted for P6 interpolation oddness)</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#   &#34;$mp3_file&#34;           &lt;- write to here (quoted for spaces)</span>
</span></span><span class="line"><span class="cl">  <span class="k">my</span> <span class="nv">$captured</span> <span class="o">=</span> <span class="k">qq</span><span class="sa">x</span><span class="p">{</span><span class="s2">ffmpeg -y -v warning -i &#34;</span><span class="nv">$ogg_file</span><span class="s2">&#34; -map_metadata &#34;0:s:0&#34; &#34;</span><span class="nv">$mp3_file</span><span class="s2">&#34;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="nb">print</span> <span class="nv">$captured</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">print</span> <span class="p">&#34;</span><span class="s2">.</span><span class="p">&#34;;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">say</span> <span class="p">&#34;</span><span class="s2">DONE</span><span class="p">&#34;;</span></span></span></code></pre>
</figure><p><a href="https://docs.perl6.org/type/IO::Path">IO::Path</a> objects understand how file and directory paths work. Constructing the <code>$mp3_file</code> filename was easy enough thanks to a little string substitution on the Path components.</p>
<p><a href="https://docs.perl6.org/language/quoting#Shell_quoting_with_interpolation:_qqx"><code>qqx</code></a> shell quoting allows variable interpolation, though Perl 6 saw <code>0:s:0</code> as a thing it needed to interpolate until I wrapped it in quotes. It took me a while to figure out the correct FFmpeg invocation, so breaking it down in the comments made sense. Oh and if there’s any output from the conversion I print it.</p>
<blockquote>
<p><strong>NOTE</strong></p>
<p>I need to remind myself that I’m putting down notes here and not writing a  tutorial, but I suggest newcomers to Perl 6 explore the <a href="https://docs.perl6.org/type.html">types</a> and <a href="https://docs.perl6.org/routine.html">routines</a>.</p>
<p>Yes, Perl 6 syntax can be strange and intimidating. You don’t need to learn all the syntax to get stuff done. The types and routines hold most of what you need for daily work. Can’t find it there? Look at the <a href="https://modules.perl6.org/">modules</a>. Easy stuff should still be easy. This is Perl, after all.</p>
</blockquote>
<h3 id="quality-control">Quality Control</h3>
<p>I used <a href="https://github.com/zoffixznet/perl6-audio-taglib-simple">Audio::Taglib::Simple</a> to double-check my work while figuring out the correct <code>ffmpeg</code> incantaion.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ sudo apt-get install libtagc0
$ zef install Audio::Taglib::Simple</code></pre>
</figure><figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-raku" data-lang="raku"><span class="line"><span class="cl"><span class="k">use</span> <span class="k">v</span><span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nn">Audio::Taglib::Simple</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="vg">@*ARGS</span> <span class="k">-&gt;</span> <span class="nv">$mp3_file</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">my</span> <span class="nv">$mp3_tags</span> <span class="o">=</span> <span class="n">Audio::Taglib::Simple</span><span class="o">.</span><span class="nb">new</span><span class="p">(&#34;</span><span class="nv">$mp3_file</span><span class="p">&#34;);</span>
</span></span><span class="line"><span class="cl">  <span class="nb">say</span> <span class="p">&#34;</span><span class="nv">$mp3_file:</span><span class="s2"> </span><span class="p">{</span><span class="nv">$mp3_tags</span><span class="o">.</span><span class="nf">title</span><span class="p">}</span><span class="s2"> - </span><span class="p">{</span><span class="nv">$mp3_tags</span><span class="o">.</span><span class="nf">album</span><span class="p">}</span><span class="s2"> - </span><span class="p">{</span><span class="nv">$mp3_tags</span><span class="o">.</span><span class="nf">artist</span><span class="p">}&#34;;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$mp3_tags</span><span class="o">.</span><span class="nf">free</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre>
</figure><p>This takes any command line arguments and presents a summary of track information for each argument. It will choke if I hand it anything that’s not an MP3 file, but for an idle weekend thing on my own machine it’s fine.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ perl6 check-mp3.p6 converted/Melvins/Houdini/*
converted/Melvins/Houdini/01 - Hooch.mp3
Hooch - Houdini - Melvins
converted/Melvins/Houdini/02 - Night Goat.mp3
Night Goat - Houdini - Melvins
converted/Melvins/Houdini/03 - Lizzy.mp3
Lizzy - Houdini - Melvins
converted/Melvins/Houdini/04 - Going Blind.mp3
Going Blind - Houdini - Melvins
converted/Melvins/Houdini/05 - Honey Bucket.mp3
Honey Bucket - Houdini - Melvins
converted/Melvins/Houdini/06 - Hag Me.mp3
Hag Me - Houdini - Melvins
converted/Melvins/Houdini/07 - Set Me Straight.mp3
Set Me Straight - Houdini - Melvins
converted/Melvins/Houdini/08 - Sky Pup.mp3
Sky Pup - Houdini - Melvins
converted/Melvins/Houdini/09 - Joan of Arc.mp3
Joan of Arc - Houdini - Melvins
converted/Melvins/Houdini/10 - Teet.mp3
Teet - Houdini - Melvins
converted/Melvins/Houdini/11 - Copache.mp3
Copache - Houdini - Melvins
converted/Melvins/Houdini/12 - Pearl Bomb.mp3
Pearl Bomb - Houdini - Melvins
converted/Melvins/Houdini/13 - Spread Eagle Beagle.mp3
Spread Eagle Beagle - Houdini - Melvins</code></pre>
</figure><p>Cool. It worked.</p>
<h3 id="what-now">What Now?</h3>
<p>I move the converted files to my <code>~/Sync</code> folder and let <a href="https://syncthing.net/">Syncthing</a> handle copying them to the Mac. They import into iTunes and I’m all done!</p>
<p>Wait. I still have to sync the files that were imported to Rhythmbox as MP3 but aren’t on iTunes yet.</p>
<p>Not today, though.</p>

  






  <hr>
  

  
    <section>
      <p>
        Got a comment? A question? More of a comment than a question?
      </p>
      <p>
        Talk to me about this page on:
        
          
        
      </p>
    </section>
  
  
<hr>
<div class="footer">
    
    
      <a class="previous-post" href="https://randomgeekery.org/post/2017/01/red/?ref=footer">
        <span style="font-weight:bold;">« Previous</span>
        <br>Red
      </a>
    
    
      <div class="next-post">
        <a href="https://randomgeekery.org/post/2017/03/maybe-ration-my-time-in-hot-take-land/?ref=footer">
          <span style="font-weight:bold;">Next »</span>
          <br>Maybe Ration My Time In Hot Take Land
        </a>
      </div>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#perl-6-star-notes">Perl 6 Star Notes</a>
      <ul>
        <li><a href="#did-i-set-up-my-path-correctly">Did I Set Up My Path Correctly?</a></li>
        <li><a href="#what-version-of-perl-6-do-i-have">What Version Of Perl 6 Do I Have?</a></li>
        <li><a href="#what-modules-do-i-have">What Modules Do I Have?</a></li>
        <li><a href="#how-do-i-get-at-the-documentation">How Do I Get At The Documentation?</a></li>
      </ul>
    </li>
    <li><a href="#quick-question-how-many">Quick question: How many?</a>
      <ul>
        <li><a href="#count-the-files-from-perl-6">Count The Files From Perl 6</a></li>
        <li><a href="#quality-control">Quality Control</a></li>
        <li><a href="#what-now">What Now?</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div><script defer data-domain="randomgeekery.org" src="https://plausible.io/js/script.js"></script>
    </body>
</html>

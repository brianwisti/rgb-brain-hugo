<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>2004onRandom Geekery</title>
    <link>https://randomgeekery.org/post/2004/</link>
    <description>
      Recent contentin2004 on Random Geekery
    </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
      
      <lastBuildDate>Mon, 22 Jan 2024 14:33:48 -0800</lastBuildDate><atom:link href="https://randomgeekery.org/post/2004/index.xml" rel="self" type="application/rss+xml" /><item>
  <title>Post: REBOL Babysteps - 01 Getting Started</title>
  <link>https://randomgeekery.org/post/2004/12/rebol-babysteps-01-getting-started/</link>
  <pubDate>Sun, 26 Dec 2004 00:00:00 -0800</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/12/rebol-babysteps-01-getting-started/</guid>
  <description>REBOL is the “Relative Expression-Based Object Language”, developed by Carl Sassenrath. Who is Carl Sassenrath? Why, he’s one of the people responsible for the amazing operating system which powered the Amiga computer. What’s the Amiga? Why, the Amiga was only the incredibly robust and cool computer — released by the same company that brought the world’s first personal computer, Commodore. What’s Commodore? Stop bothering me, kid. Take it from a relative old-timer: Amiga put a heck of a lot of power into a consumer-affordable personal computer.</description>
   <category>post</category> 
   <category>post</category> 
   <category>rebol</category>  <category>learn</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<p><a href="/card/rebol/">REBOL</a> is the &ldquo;Relative Expression-Based Object Language&rdquo;, developed by Carl Sassenrath. Who is Carl Sassenrath? Why, he’s one of the people responsible for the amazing operating system which powered the Amiga computer. What’s the Amiga? Why, the Amiga was only the incredibly robust and cool computer — released by the same company that brought the world’s first personal computer, Commodore. What’s Commodore? Stop bothering me, kid. Take it from a relative old-timer: Amiga put a <em>heck</em> of a lot of power into a consumer-affordable personal computer. It wasn’t really matched by other computers for a good five or ten years. Nowadays, I look at <a href="http://www.rebol.com/">REBOL</a> and it feels like the first language I’ve come across to take lessons from past languages and apply them in a new context, rather than just reimplement them with different syntax.</p>
<p>So why would you want to learn REBOL? Because REBOL makes it frighteningly easy to create programs that accomplish complex tasks. For example, here’s one way you can download the HTML source of a Web page – for example <a href="https://randomgeekery.org/">https://randomgeekery.org/</a> – and view it in a text editing area with REBOL/View:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; view layout [ area 800x600 read https://randomgeekery.org ]</code></pre>
</figure><p>This impresses me to no end. Maybe you’re not so impressed by it, but that’s okay. I’m happy, and that’s what I care about most.</p>
<p>These pages are intended to provide the non-programmer with a gentle introduction to the REBOL language and environment. When you are done with it, you should feel ready to learn more, and curious to dig into the possibilities. You won’t be an expert, but maybe you’ll feel bold enough to become one and share what you’ve found with the rest of the world. Beginners and experts alike should feel free to send suggestions about how I can improve this tutorial.</p>
<h2 id="installing-rebol">Installing REBOL</h2>
<p>Installing REBOL is a straightforward task, as long as you are using one of the 40+ supported platforms.</p>
<h3 id="platform-notes">Platform Notes</h3>
<h4 id="installation-on-windows">Installation on Windows</h4>
<ul>
<li>Download the archived installer for your platform from
<ul>
<li><a href="http://www.rebol.com/download.html">http://www.rebol.com/download.html</a></li>
</ul>
</li>
<li>Unpack the installer, if necessary</li>
<li>Run the installer</li>
<li>Follow the installation wizard until you have installed the version you downloaded.</li>
</ul>
<h4 id="installation-on-linux">Installation on Linux</h4>
<p>Here is what I had to do in order to get REBOL/Core and REBOL/View running on my Ubuntu laptop:</p>
<ul>
<li>Install a compatibility version of the GNU Standard C++ library
<ul>
<li><code>sudo apt-get install libstdc++5</code></li>
</ul>
</li>
<li>Download, extract, and copy the <code>rebcore</code> executable into my path
<ul>
<li><code>wget http://rebol.com/downloads/v276/rebcore-linx86.tar.gz</code></li>
<li><code>tar xfvz rebcore-linx86.tar.gz</code></li>
<li><code>sudo cp rebol-276/rebol /usr/local/bin</code></li>
</ul>
</li>
<li>Download, extract, and copy the <code>rebview</code> executable into my path
<ul>
<li><code>wget http://rebol.com/downloads/v276/rebview-linx86.tar.gz</code></li>
<li><code>tar xfvz rebview-linx86.tar.gz</code></li>
<li><code>sudo cp rebol-276/rebview /usr/local/bin</code></li>
</ul>
</li>
</ul>
<p>Why did I install both Core and View? There’s no real need to. I just prefer to include a version of REBOL that doesn’t depend on X libraries for scripting tasks that will never need a Viewtop. It’s particularly handy for Web programming tasks.</p>
<p>There’s an intermittent problem with ugly fonts when using View under Linux. I’ll post instructions for handling that on this site as soon as I find my notes.</p>
<h3 id="which-version">Which Version?</h3>
<p>You have a few different choices for what version of REBOL to download, depending on what you need and what is available for your platform.</p>
<h4 id="rebolcore">REBOL/Core</h4>
<blockquote>
<p><a href="http://www.rebol.com/prod-core.html">http://www.rebol.com/prod-core.html</a></p>
</blockquote>
<p>REBOL/Core covers the vital language features, including all the <a href="/post/2004/12/rebol-datatypes/">datatypes</a> which make the language so attractive to somebody like me. With Core, you can create system shell scripts, CGI applications, or simple command-line applications. Core also provides an interactive shell for testing out code on the fly, which is a valuable asset for getting the hang of a language, or even just trying out an obscure bit of code on a bored Thursday evening.</p>
<p>Find out if REBOL/Core has been released for your platform at this URL:</p>
<blockquote>
<p><a href="http://rebol.com/platforms.html">http://rebol.com/platforms.html</a></p>
</blockquote>
<p>REBOL/Core will probably do fine for most hobbyists, but you might want to look on if you enjoy pointy clicky GUI environments as much as I do.</p>
<h4 id="rebolview">REBOL/View</h4>
<blockquote>
<p><a href="http://www.rebol.com/prod-view.html">http://www.rebol.com/prod-view.html</a></p>
</blockquote>
<p>View is the cool one, in my opinion. It adds an impressive GUI library to Core, making it immediately useful for a broad range of applications. The utility of View can be compared to Java, but here’s something to really think about regarding the contrast between View and Java. How big of a download is the JDK these days? 10 Megabytes, 40 Megabytes? The REBOL/View installer for Windows is 600 Kilobytes. You can fit it on a <em>floppy disk</em>.</p>
<p>What’s a floppy disk? I thought I told you to stop bothering me, kid.</p>
<p>Find out if REBOL/View has been released for your platform at this URL:</p>
<blockquote>
<p><a href="http://rebol.com/view-platforms.html">http://rebol.com/view-platforms.html</a></p>
</blockquote>
<h4 id="rebolsdk-and-rebolcommand">REBOL/SDK and REBOL/Command</h4>
<p>These are also very easy to get, and add a number of useful features to REBOL/View. I’ll be ignoring them for now, because they have a dollar cost associated with them.</p>
<h2 id="using-rebol">Using REBOL</h2>
<p>In Windows, all you need to do is find REBOL in your Start menu. In Linux, it should be directly callable from your command line if you handled installation the same way I described.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ rebol
REBOL/Core 2.7.6.4.2 (15-Mar-2008)
Copyright 2008 REBOL Technologies
REBOL is a Trademark of REBOL Technologies
All rights reserved.

Finger protocol loaded
Whois protocol loaded
Daytime protocol loaded
SMTP protocol loaded
ESMTP protocol loaded
POP protocol loaded
IMAP protocol loaded
HTTP protocol loaded
FTP protocol loaded
NNTP protocol loaded
&gt;&gt;</code></pre>
</figure><p>So double-click its icon or run it from the command-line. Either way, now the REBOL shell is running for you. If you’ve installed View, then you’ve got this pretty Desktop thing. We’ll have to come back to it some other time. For now, just click the icon on the left for &ldquo;Console&rdquo;. <em>Now</em> you’ve got the console. It is not as pretty, but it will work for our purposes.</p>
<p>You can also go straight to the console when executing <code>rebview</code> from the command line by using the <code>-v</code> option:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ rebview -v</code></pre>
</figure><h2 id="how-to-use-rebolcore">How to use REBOL/Core</h2>
<p>Getting REBOL to do something for you is as simple as typing in the commands and looking at the results.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; print &#34;Hello, World!&#34;
Hello, World!</code></pre>
</figure><p>See? Not that hard at all. Of course, this is pretty standard stuff from most programming languages these days. Well, except Java. But we all just sort of snicker whenever a Java coder enters the room. We would snicker more, but that Java coder is <em>probably</em> making twice what we are. He deserves it, too, for all the carpal tunnel he’s going to get when he tries to write a &ldquo;Hello World&rdquo; program.</p>
<p>Making the computer tell us things is kind of fun, but it would be nice to customize it a little bit. Let’s have the computer ask our name. We can use the <code>ask</code> function (or <em>word</em>) to ask a question and get a response, which we will save in a variable.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; name: ask &#34;Enter your name: &#34;
Enter your name:</code></pre>
</figure><p>REBOL uses <em>words</em> to remember everything. These words can describe a number, your name, a chunk of programming logic, or pretty much anything else you want to track. Here, we have created a word <code>name</code>, and used the function described by <code>ask</code> to set <code>name</code> to whatever you enter as your name. What? You still haven’t done that? Go ahead, it’s painless.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; name: ask &#34;Enter your name: &#34;
Enter your name: Brian
== &#34;Brian&#34;</code></pre>
</figure><p>Type in your name, whether it’s &ldquo;Brian&rdquo;, &ldquo;Craig&rdquo;, &ldquo;Sarah&rdquo;, or &ldquo;Zuul the Destroyer&rdquo;. Your name is immediately printed back out onto the console. But how do we know that REBOL has remembered it? Just <code>print</code> the name:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; print name
Brian</code></pre>
</figure><p>That works, and is in the same spirit as the other tutorials on coolnamehere, but this seems like a great opportunity to take a look at the <code>help</code> word. <code>help</code> describes a function that can look up information about any word that REBOL is currently tracking. Here, try it for <code>name</code>:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; help name
NAME is a string of value: &#34;Brian&#34;</code></pre>
</figure><p>You can get even more information when the word is pointing to a function or other complex datatypes. See what happens when you ask <code>help</code> about itself.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; help help
USAGE:
    HELP &#39;word

DESCRIPTION:
     Prints information about words and values.
     HELP is a function value.

ARGUMENTS:
     word -- (Type: any-type)</code></pre>
</figure><p>Remember <code>help</code>. It may be just the thing you need when you’re confused by what a word is supposed to do. As an exercise, go ahead and starting by asking <code>help</code> about <code>ask</code> or <code>print</code>.</p>
<p>Let’s return to our tutorial, already in progress…</p>
<p>Now that we know REBOL has remembered the name, let’s print it as part of a sentence. You can tell <code>print</code> to print several things at once by putting them in a block. We do this by wrapping it in square brackets.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; print [ &#34;Hello&#34; name &#34;- good to see you!&#34; ]
Hello Brian - good to see you!</code></pre>
</figure><p>Hey, that made me feel pretty good! As always, it’s great how much we can be cheered up by just a few nice words, even if we have to write them ourselves. What if we wanted to share that warm feeling with our friends and neighbors, or at least the ones who have a copy of REBOL on their machine?</p>
<p>Let’s find our how to do that.</p>
<h2 id="how-to-make-your-own-rebol-script">How to make your own REBOL script</h2>
<p>Using your favorite <em>Editor</em>, type this text in and save it as <code>hello.r</code>. I like to keep my code files in a special &ldquo;projects&rdquo; directory, to keep from losing them in a mass of articles, pictures, and random files. You might want to follow the same habit, but it’s entirely up to you.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >REBOL [
   Title: &#34;Hello User&#34;
   File: %hello.r
]

name: ask &#34;Please enter your name: &#34;
print [ &#34;Hello&#34; name &#34;- good to see you!&#34; ]</code></pre>
</figure><p>Make sure that you are using an editor which saves its files as plain text. REBOL can’t make any sense of Word documents or HTML.</p>
<h3 id="the-script-header">The Script Header</h3>
<p>You recognize the code from before, but I imagine you’re curious about the block prefaced by the word <code>REBOL</code>. That is the <em>script header</em>, where you put important information about the script that you are writing. You need to put something, even if it’s just an empty block, or Rebol won’t recognize it as a script.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >REBOL [ ]</code></pre>
</figure><p>Still, the whole point of a script header is to get information about what the script is, where it came from, and any other details which you think might be useful to somebody who uses it. An empty block is hardly useful. This is considered to be more of an acceptable minimal block for a script you want to share with the world:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >REBOL [
    Title: &#34;Hello User&#34;
    Date: 22-Dec-2004
    File: %hello.r
    Author: &#34;Brian Wisti&#34;
    Version: 1.0.0
]

name: ask &#34;Please enter your name: &#34;
print [&#34;Hello&#34; name &#34;- good to see you!&#34;]</code></pre>
</figure><p>Of course, you could always provide more information if you want.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >REBOL [
    Title: &#34;Hello User Example Script&#34;
    Date: 24-Feb-2009
    Name: &#39;Hello-User

    Version: 1.0.2
    File: %hello.r
    Home: http://randomgeekery.org/tags/rebol/

    Author: &#34;Brian Wisti&#34;
    Owner: &#34;Brian Wisti&#34;
    Rights: &#34;Copyright (C) 2017 Brian Wisti&#34;

    Needs: [] ; Needs nothing beyond REBOL/Core
    Tabs: 4

    Purpose: {
        This program is a simple script to demonstrate usage of
        REBOL and warm you up for trying more complex tasks.
    }

    History: {
        1.0.0 [22-Dec-2004 &#34;Wrote the code&#34;]
        1.0.1 [23-Dec-2004 &#34;Finished writing the header for the code&#34;]
        1.0.2 [24-Feb-2009 &#34;Re-examined for site update&#34;]
        1.0.3 [09-Apr-2017 &#34;Adjusted for site relocation&#34;]
    }

    Language: &#39;English
]

name: ask &#34;Please enter your name: &#34;
print [&#34;Hello&#34; name &#34;- good to see you!&#34;]</code></pre>
</figure><p>Just try to keep the size of the script header appropriate for the size of your script. A full script header might be overkill for a script with only two lines of code - unless you happen to think that people need a lot of information when handling your script.</p>
<h3 id="running-your-script">Running your script</h3>
<p>There are two ways to actually load your script and make it do its thing.</p>
<ul>
<li>From the interactive Rebol console</li>
<li>From the command line.</li>
</ul>
<p>Actually, there are a couple more ways to go about it, but these are the main approaches if you are running a simple Rebol/Core script like the one we’ve written.</p>
<p>From the interactive console, I use the <code>do</code> command to execute the script <code>C:\projects\hello.r</code>:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; do %\c\projects\hello.r</code></pre>
</figure><p>The first time you do this, REBOL might ask you for permission to run the script. Nothing to worry about, it’s just REBOL being conscious about security. Just say ``Yes&rsquo;&rsquo;, and the script will run through merrily.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; do %hello.r
Script: &#34;Hello User&#34; (none)
Please enter your name: Brian
Hello Brian - good to see you!</code></pre>
</figure><p>If REBOL is in your path, you can call the <code>rebol</code> executable with your script name as an argument.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ rebol hello.r
REBOL/Core 2.7.6.4.2 (15-Mar-2008)
Copyright 2008 REBOL Technologies
REBOL is a Trademark of REBOL Technologies
All rights reserved.

Finger protocol loaded
Whois protocol loaded
Daytime protocol loaded
SMTP protocol loaded
ESMTP protocol loaded
POP protocol loaded
IMAP protocol loaded
HTTP protocol loaded
FTP protocol loaded
NNTP protocol loaded
Script: &#34;Hello User&#34; (none)
Please enter your name: Brian
Hello Brian - good to see you!</code></pre>
</figure><p>Oof. That’s a whole lot of text before you actually see your program. Use the <code>-q</code> option to make REBOL run your script more quietly.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ rebol -q hello.r
Please enter your name: Brian
Hello Brian - good to see you!</code></pre>
</figure><p>REBOL also supports the classic &ldquo;shebang&rdquo; line for UNIX shell scripts.</p>
<ul>
<li>Insert a new line at the very beginning, pointing to the <code>rebol</code> executable
<ul>
<li><code>#!/usr/local/bin/rebol -q</code></li>
</ul>
</li>
<li>Make the script executable
<ul>
<li><code>chmod 755 hello.r</code></li>
</ul>
</li>
<li>Run it
<ul>
<li><code>./hello.r</code></li>
</ul>
</li>
</ul>
<p>Cool, eh? Now you can share this script with all of your Rebol friends just by sending them the file. Of course, you might want to send them something more impressive, but think of it this way - this just gives you the motivation to learn how to do <em>more</em>!</p>
<h2 id="wrapping-up">Wrapping Up</h2>
<p>There you have it. You’ve learned how to write a simple script. Heck,
I’ve even snuck in a couple of Rebol’s many datatypes while you weren’t looking. You’re well on the way to becoming a real Rebol programmer!</p>
<p>There is a lot of documentation available for REBOL, especially considering that the REBOL community is fairly small. RT keeps the official manuals available for free, and there are loads of script libraries and how-to guides written by the users themselves.</p>
<blockquote>
<p><a href="http://www.rebol.com/docs.html">http://www.rebol.com/docs.html</a></p>
</blockquote>
<p><em>P.S.:</em> What, you want me to tell you how to quit REBOL? Why would you ever want to do that? Oh, okay. The command to quit from the REBOL Console is easy to remember: <code>quit</code>. Happy now?</p>
]]></content:encoded>
</item>
<item>
  <title>Post: REBOL Babysteps - 02 Getting Started With View</title>
  <link>https://randomgeekery.org/post/2004/12/rebol-babysteps-02-getting-started-with-view/</link>
  <pubDate>Sun, 26 Dec 2004 00:00:00 -0800</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/12/rebol-babysteps-02-getting-started-with-view/</guid>
  <description>I’m sure you thought that getting started was fun, but it really didn’t do anything to show off post/2004/12/rebol. I’d like to go through almost exactly the same process, but this time focussing my attention on REBOL/View. So let’s give it a try!
I’m going to skim through this very quickly. The goal is just for you to see how much potential there is in the REBOL/View dialect. You want to see “Hello World”?</description>
   <category>post</category> 
   <category>post</category> 
   <category>rebol</category>  <category>learn</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<p>I’m sure you thought that getting started was fun, but it really didn’t do anything to show off <a href="/post/2004/12/rebol/">post/2004/12/rebol</a>. I’d like to go through almost exactly the same process, but this time focussing my attention on <a href="http://www.rebol.com/prod-view.html">REBOL/View</a>. So let’s give it a try!</p>
<p>I’m going to skim through this very quickly. The goal is just for you to see how much potential there is in the REBOL/View dialect. You want to see &ldquo;Hello World&rdquo;? Here it is.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; view layout [ text &#34;Hello World!&#34; ]</code></pre>
</figure><p><figure>
    <img src="/attachments/img/2004/rebol-intro-01.png" alt="Hello World in REBOL/View"/></figure></p>
<p>One way to interpret that series of commands is along the lines of: we want to <code>view</code> the <code>layout</code> defined as containing the <code>text</code> &ldquo;Hello World&rdquo;. I’ll be the first to admit that this is not an impressive demonstration of GUI programming — unless you’ve actually done some, then you might notice how quick it was to put together compared to using a lot of other toolkits and platforms.</p>
<p>Still, the whole point of using a GUI is having something to <em>click</em>. Let’s revisit our script from last time and putting some pointy-clicky goodness into it.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; view layout [
[    text &#34;Enter your name&#34;
[    field
[    button &#34;Hi!&#34;
[    ]</code></pre>
</figure><p><figure>
    <img src="/attachments/img/2004/rebol-intro-02.png" alt="Asking for a name"/></figure></p>
<p>Neat. Except that it doesn’t actually do anything if you click the button. Pretty, but non-functional - sort of like my neighbor’s car. Let’s give the <code>button</code> a block of commands along with the string &ldquo;Hi!&rdquo;.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; view layout [
[    text &#34;Enter your name&#34;
[    field
[    button &#34;Hi!&#34; [
[        alert &#34;Hello there!&#34;
[        ]
[    ]</code></pre>
</figure><p>Sorry, I haven’t gotten a screenshot of the alert just yet. Trust me, though. It’s pretty standard fare for alert boxes. It still doesn’t have that personal touch that the script from <a href="/post/2004/12/rebol-babysteps-01-getting-started/">last time</a> did, though. Let’s add a few touches: a little word assignment here, a little phrase-building there with <code>rejoin</code> and some refinements. There, how about this?</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >&gt;&gt; view layout [
[    text &#34;Enter your name&#34;
[    name: field
[    button &#34;Hi!&#34; [
[        message: rejoin [ &#34;Hello &#34; name/text &#34; - great to see you!&#34; ]
[        alert message
[        ]
[    ]</code></pre>
</figure><p>Hey, that was neat. We’ve got a pointy-clicky version of the &ldquo;Hello&rdquo; script we made last time. We assigned the field to a word and then used what REBOL calls &ldquo;refinements&rdquo; to access the text entered into that field. You will see a lot about refinements as your knowledge of REBOL progresses.</p>
<p>Let’s turn this into a script so we can share our newfound REBOL/View knowledge with our other friends who have REBOL/View installed.</p>
<h2 id="a-rebolview-script">A REBOL/View Script</h2>
<p>Just rewrite the code in your favorite text editor. Don’t forget the script header we talked about last time, and the shebang line if you’re on Linux!</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >#!/usr/local/bin/rebview -q

REBOL [
    Title: &#34;Hello World!&#34;
    File:  %vHello.r
    Author: Brian Wisti
]

view layout [
    text &#34;Enter your name&#34;
    name: field
    button &#34;Hi!&#34; [
        message: join  &#34;Hello &#34; [
            name/text &#34; - great to see you!&#34;
        ]
        alert message
    ]
]</code></pre>
</figure><p>You still have the same execution options as before, but REBOL/View under Windows gives you an additional choice. You can find your View script via Explorer and double-click. Easy as that!</p>
<h2 id="all-done">All Done</h2>
<p>This overview didn’t even scratch the surface of REBOL/View. It didn’t even <em>touch</em> the surface, but instead just gave the surface a sideways glance while hurrying to an urgent appointment. I encourage you to take a closer look at REBOL/View and its official documentation.</p>
]]></content:encoded>
</item>
<item>
  <title>Post: REBOL Datatypes</title>
  <link>https://randomgeekery.org/post/2004/12/rebol-datatypes/</link>
  <pubDate>Sun, 26 Dec 2004 00:00:00 -0800</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/12/rebol-datatypes/</guid>
  <description>One of REBOL’s strengths is the rich selection of native datatypes. This selection is part of what makes it so easy to express solutions to your problems, because there is less ``mental mapping’’ to make as you use or create an abstract type to represent an important concept. Learning this selection is also one of the challenges for those who are trying to master the language. I am facing that challenge right now, so I decided to make this table of native REBOL datatypes and how they are expressed.</description>
   <category>post</category> 
   <category>post</category> 
   <category>rebol</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<p>One of <a href="/card/rebol/">REBOL</a>’s strengths is the rich selection
of native datatypes. This selection is part of what makes it so easy to
express solutions to your problems, because there is less ``mental
mapping&rsquo;&rsquo; to make as you use or create an abstract type to represent an
important concept. Learning this selection is also one of the challenges
for those who are trying to master the language. I am facing that
challenge right now, so I decided to make this table of native REBOL
datatypes and how they are expressed.</p>
<p>You can find the full description of all datatypes, along with detailed
information about usage, at the following url:</p>
<blockquote>
<p><a href="http://rebol.com/docs/core23/rebolcore-16.html">http://rebol.com/docs/core23/rebolcore-16.html</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>Datatype</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Decimal</td>
<td><code>1.2</code></td>
<td>A number with a fractional component</td>
</tr>
<tr>
<td>Integer</td>
<td><code>4</code></td>
<td>A whole number</td>
</tr>
<tr>
<td>Binary</td>
<td><code>#{ccffcc}</code></td>
<td>Numbers that don’t use a 10-based system (binary, hex, 64-encoded)</td>
</tr>
<tr>
<td>Block</td>
<td><code>[ 1 1.2 &quot;Dude!&quot; ]</code></td>
<td>A collected group of values and words</td>
</tr>
<tr>
<td>Email</td>
<td><code>dude@sweet.com</code></td>
<td>An email address</td>
</tr>
<tr>
<td>File</td>
<td><code>%path/to/file.txt</code></td>
<td>The name of a file or directory</td>
</tr>
<tr>
<td>Hash</td>
<td><code>to-hash [ 1 &quot;uno&quot; 2 &quot;dos&quot; 3 &quot;tres&quot; ]</code></td>
<td>A specialized block for quickly finding data - <em>sort of like dictionaries or associative arrays in other languages</em></td>
</tr>
<tr>
<td>Image</td>
<td><code>image: load %logo.jpg</code></td>
<td>A specialized block for holding RGB images - <em>You can also use binary formatting to describe the image within the document itself, if you want</em></td>
</tr>
<tr>
<td>Issue</td>
<td><code>#Pock-Y-STX-5</code></td>
<td>Handy for phone numbers, serial codes, clone identification, or credit cards</td>
</tr>
<tr>
<td>List</td>
<td><code>to-list[1 2 3]</code></td>
<td>A specialized block for quickly handling large numbers of insertions and removals</td>
</tr>
<tr>
<td>Paren</td>
<td><code>1 + (2 * 3)</code></td>
<td>A block that forces immediate evaluation of the values and words it contains</td>
</tr>
<tr>
<td>Path</td>
<td><code>/geekery/rebol/datatypes</code></td>
<td>Used to navigate to or find something. Think of subscripting or object methods, and you’re along the right track.</td>
</tr>
<tr>
<td>String</td>
<td><code>&quot;Dude! What's mine say?&quot;</code></td>
<td>A series of characters. What we humans often use to form words and sentences.</td>
</tr>
<tr>
<td>Tag</td>
<td><code>&lt;img src=&quot;slor.jpg&quot; /&gt;</code></td>
<td>An HTML tag. Having tags as a native datatype makes parsing and writing Web pages very simple.</td>
</tr>
<tr>
<td>URL</td>
<td><code>http://www.rebol.com/</code></td>
<td>A URL, used for finding stuff on the Internet.</td>
</tr>
<tr>
<td>Character</td>
<td><code>#&quot;Z&quot;</code></td>
<td>Not a string, but a single, solitary character.</td>
</tr>
<tr>
<td>Date</td>
<td><code>23-Dec-2004</code></td>
<td>A single specific calendar date, and sometimes the time to go along with it - <em>can be created in a dizzying number of ways in REBOL</em></td>
</tr>
<tr>
<td>Logic</td>
<td><code>true</code></td>
<td>The basic boolean values used for evaluating any yes or no questions.</td>
</tr>
<tr>
<td>Money</td>
<td><code>$8.24</code></td>
<td>Monetary values. That stuff I never seem to have 2 days after payday.</td>
</tr>
<tr>
<td>None</td>
<td><code>none</code></td>
<td>Nothing. No value. Not even zero. Zen, man. - <em>okay, I’m getting a little goofy now</em></td>
</tr>
<tr>
<td>Pair</td>
<td><code>320x200</code></td>
<td>An (X,Y) ordered pair used for coordinates on a display or sizes.</td>
</tr>
<tr>
<td>Refinement</td>
<td><code>system/version</code></td>
<td>Modifiers used to indicate some variation or extension in the meaning of a value - <em>Adjectives, basically. Neat, eh?</em></td>
</tr>
<tr>
<td>Time</td>
<td><code>16:25</code></td>
<td>Hours, minutes, and even seconds, if you like. <em>An entire category of C programming exercises becomes meaningless thanks to this</em></td>
</tr>
<tr>
<td>Tuple</td>
<td><code>127.0.0.1</code></td>
<td>A &ldquo;dotted series&rdquo; of integers, often useful for version numbers, net addresses, and color values.</td>
</tr>
<tr>
<td>Words</td>
<td><code>word</code></td>
<td>Symbols used by REBOL. Might be a variable - or not, depending on how you use it.</td>
</tr>
</tbody>
</table>
<p>And remember, basically everything is a datatype. Even datatypes.</p>
]]></content:encoded>
</item>
<item>
  <title>Post: REBOL Babysteps</title>
  <link>https://randomgeekery.org/post/2004/12/rebol-babysteps/</link>
  <pubDate>Sat, 25 Dec 2004 00:00:00 -0800</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/12/rebol-babysteps/</guid>
  <description>Right. Here is this language that you’ve never heard of: REBOL. I think we should learn how to use it together, sort of a “Babysteps” approach. You and I can add REBOL to our steadily expanding toolkit of programming languages.
And remember to just ignore people when they ask you “Why should I learn REBOL (or Perl, or Python, or Ruby) instead of Perl (or Python, or Ruby, or Java)?” You and I are the sort of people who learn a language in addition to the ones we already know, not instead of the one we were taught in college.</description>
   <category>post</category> 
   <category>post</category> 
   <category>rebol</category>  <category>learn</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<p>Right. Here is this language that you’ve never heard of: <a href="/card/rebol/">REBOL</a>. I think we should learn how to use it together, sort of a &ldquo;Babysteps&rdquo; approach. You and I can add REBOL to our steadily expanding toolkit of programming languages.</p>
<p>And remember to just ignore people when they ask you “Why should I learn REBOL (or Perl, or Python, or Ruby) instead of Perl (or Python, or Ruby, or Java)?” You and I are the sort of people who learn a language <em>in addition</em> to the ones we already know, not <em>instead of</em> the one we were taught in college.</p>
<p>Okay, maybe that is a little rude. But it works like this: my music teacher taught me that each time you learn a new instrument, it gets a little easier to learn new ones, because you are developing a greater understanding of how to make music. You will also know how to choose the best instrument for a particular piece, because you understand the differences between each available choice. I didn’t learn much musically. I only managed two things:</p>
<ol>
<li>Use a trumpet to make a sound like a dying elephant.</li>
<li>Use a clarinet to make a sound like an angry weasel.</li>
</ol>
<p>… so I’m sure he’ll be happy to learn that I walked away with <em>something</em> from his class.</p>
<p>So yeah. That’s why you want to learn REBOL. So you can make a sound like an angry weasel. No, make that a <em>happy</em> weasel.</p>
<p>I add a new page to this tutorial every once in a while, but I don’t believe it’s the best REBOL tutorial available. That honor goes to Nick Antonaccio’s <a href="http://musiclessonz.com/rebol_tutorial.html">Rebol Programming For The Absolute Beginner</a>. I think you should go over there and check it out now. Go ahead, I don’t mind.</p>
]]></content:encoded>
</item>
<item>
  <title>Post: REBOL</title>
  <link>https://randomgeekery.org/post/2004/12/rebol/</link>
  <pubDate>Wed, 22 Dec 2004 00:00:00 -0800</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/12/rebol/</guid>
  <description>This is unusual. I’ve come across the first language that I don’t want to tell you about. I don’t know why I want to keep REBOL a secret. It has been very useful even in the limited roles that I have given it so far. The language is consistent and pleasant to work with. It has a richness of datatypes that just can’t be matched by other languages. The GUI library View is surprisingly straightforward for simple tasks, and there are excellent libraries like RebGUI to make it just as easy for more elaborate interfaces.</description>
   <category>post</category> 
   <category>post</category> 
   <category>rebol</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<p>This is unusual. I’ve come across the first language that I don’t want
to tell you about. I don’t know <em>why</em> I want to keep <a href="/card/rebol/">REBOL</a> a secret. It has been very useful even in the limited roles that I have given it so far. The language is consistent and pleasant to work with. It has a richness of datatypes that just can’t be matched by other languages. The GUI library View is surprisingly straightforward for simple tasks, and there are excellent libraries like RebGUI to make it just as easy for more elaborate interfaces.</p>
<p>Maybe I just want to think of REBOL as my secret weapon. Languages aren’t like that, though, so my conscience tells me that I must at least mention it to you before burying myself back in the routine of my day.</p>
<p>So what do I use REBOL for? Well, I spent about five minutes making a simple GUI application to help me balance my checkbook, for starters. I enter my transactions, it saves them and shows me my current balance <em>(along with the record of previous transactions)</em>. It’s really nothing special, but it was disturbingly easy to create.</p>
<p>Give REBOL a look-see. You might like it.</p>
<p>Oh, there is a random bit of trivia that amused and unnerved me when I first discovered it. REBOL Technologies is based in Ukiah, California, where I spent those vitally important early childhood years. I was only there from age six to age eight, but a lot of my thoughts, beliefs, etcetera were established among the redneck hippies of northern California. And now there’s this cool language coming from the same town. Freaky.</p>
<h2 id="rebol-links">REBOL Links</h2>
<p>The Rebol community is incredibly active for its small size. To me, this says a lot about Rebol’s potential in the future, and I would like to do what I can to encourage others to at least take a look at the language and some of the sites devoted to Rebol out on the Web. There are more links than these, but I’m pointing out the ones that I have been using or referring to a lot.</p>
<ul>
<li><a href="http://www.rebol.com/">http://www.rebol.com/</a></li>
</ul>
<h3 id="tutorials">Tutorials</h3>
<ul>
<li><a href="http://musiclessonz.com/rebol_tutorial.html">http://musiclessonz.com/rebol_tutorial.html</a> - An <em>excellent</em>   introduction to REBOL and REBOL/View. More thorough than any of my meanderings and updated more frequently, too.</li>
<li><a href="http://www.plain.at/vpavlu/REBOL/tutorial/">http://www.plain.at/vpavlu/REBOL/tutorial/</a></li>
<li><a href="http://www.onlamp.com/pub/a/onlamp/2003/10/30/rebol.html">http://www.onlamp.com/pub/a/onlamp/2003/10/30/rebol.html</a></li>
<li><a href="http://rebol.com/docs/core23/rebolcore.html">http://rebol.com/docs/core23/rebolcore.html</a></li>
<li><a href="http://rebol.com/docs/easy-vid.html">http://rebol.com/docs/easy-vid.html</a></li>
</ul>
<h3 id="community">Community</h3>
<ul>
<li><a href="http://www.rebol.org/">http://www.rebol.org/</a></li>
<li><a href="http://compkarori.com/vanilla/display/rebol-main">http://compkarori.com/vanilla/display/rebol-main</a></li>
<li><a href="http://www.reboltalk.com/">http://www.reboltalk.com/</a></li>
<li><a href="http://www.rebolplanet.com/">http://www.rebolplanet.com/</a></li>
</ul>
<h3 id="applications-created-with-rebol">Applications created with REBOL</h3>
<ul>
<li><a href="http://www.altme.com/">AltMe</a> : An instant messenger</li>
<li><a href="http://www.vanillasite.at/">http://www.vanillasite.at/</a> : A Wiki engine</li>
<li><a href="http://www.rebol.com/docs/desktop.html">http://www.rebol.com/docs/desktop.html</a> : The REBOL/View Desktop is yet another impressive distributed application, allowing you to peruse the World Wide Reb.</li>
<li><a href="http://www.rebol.org/">http://www.rebol.org/</a> : I know I already mentioned it in &ldquo;Community&rdquo;, but it was built with and runs on REBOL. You really   have to start digging into it before you appreciate what a fine piece of work this site is.</li>
</ul>
]]></content:encoded>
</item>
<item>
  <title>Post: Lisp</title>
  <link>https://randomgeekery.org/post/2004/10/lisp/</link>
  <pubDate>Thu, 28 Oct 2004 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/10/lisp/</guid>
  <description>Okay, I’ll be honest. LISP scares the dickens out of me. It’s ancient by the standards of computer languages. The language is completely different from any of the stuff I use in my day-to-day programming. Yet it has all the features of those languages and more. Garbage collection? Got it. The ability to pass functions around as easily as an integer? Done (and not in a cranky C function pointer manner, either).</description>
   <category>post</category> 
   <category>post</category> 
   <category>coolnamehere</category> 
  <content:encoded><![CDATA[<p>Okay, I’ll be honest. LISP scares the dickens out of me. It’s ancient by the standards of computer languages. The language is completely different from any of the stuff I use in my day-to-day programming. Yet it has all the features of those languages and more. Garbage collection? Got it. The ability to pass functions around as easily as an integer? Done (and not in a cranky C function pointer manner, either). Object-oriented programming? Well sure, but you might not need it as much as you thought you did. Not only that - LISP has had these features for <em>decades</em>.</p>
<p><a href="http://www.paulgraham.com/">Paul Graham</a> is a high-profile proponent of LISP. He seems to think that his early success in developing online applications was due to the power and flexibility of LISP and his theory that independent-minded hackers are innately destined for greater things than the mundane cattle that walk the earth. I’m not going to argue with him, since I’m not a master of LISP, business management, or socio-economic theory. I do wish he’d find something more interesting to talk about than hackers, though.</p>
<p>Sorry, I digressed. As I was saying: Paul Graham is a high-profile proponent of LISP. His book <a href="http://www.paulgraham.com/acl.html">ANSI Common LISP</a> is on the bookshelf of nearly every would-be LISP hacker, and for good reason. His book is concise and informative. It continues to be useful after finishing the tutorial section, thanks to a convenient reference section in the back. You’ll probably get some respect from your fellow nerds if you have any of Paul Graham’s LISP titles on your shelf. That includes those who get bored and annoyed while reading his <a href="http://www.paulgraham.com/articles.html">essays</a> discussing how the ancient Egyptians who designed the pyramids were actually hackers who utilized the existing labor system in previously unimagined ways. Note: I don’t think he’s actually written that essay yet.</p>
<p><em>ANSI Common LISP</em> is popular and useful, but I needed a friendlier approach to learning this intimidating language. That’s why I preferred <a href="http://www.gigamonkeys.com/book/">Practical Common LISP</a> by Peter Seibel. It takes a more leisurely stroll through the awkward first steps with LISP. The author understands the widespread fear of LISP and takes it into account through each lesson and project. You will definitely have an understanding of the language and its possible uses by the time you’re finished. I highly recommend <em>Practical Common LISP</em> for your first book as a <a href="http://c2.com/cgi/wiki?SmugLispWeenie">Smug Lisp Weenie</a>. Then go right into Paul Graham’s books or some of the arcane titles that come out of the MIT Press with titles that are sure to impress your friends and frighten the neighbors.</p>
]]></content:encoded>
</item>
<item>
  <title>Post: Drawing Celtic Knotwork</title>
  <link>https://randomgeekery.org/post/2004/10/drawing-celtic-knotwork/</link>
  <pubDate>Fri, 01 Oct 2004 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/10/drawing-celtic-knotwork/</guid>
  <description>2020-08-01
Ye gods. 15,000 words?
I cut this down into smaller blocks after that Raku tangling post. I don’t even care that this post is 16 years old. Somebody might accidentally try to read it!
I touched up what I could without destroying the flow, but things would look much different if I wrote this post today.
Thanks to everybody for the positive feedback on the first MIRE. I still have your attention, so I’ll move on to my next exercise.</description>
   <category>post</category> 
   <category>post</category> 
   <category>ruby</category>  <category>learn</category>  <category>celtic</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<blockquote>
<p><strong>2020-08-01</strong></p>
<p>Ye gods. 15,000 words?</p>
<p>I cut this down into smaller blocks after that <a href="/post/2020/07/tangling-code-from-hugo-content-with-raku/">Raku tangling post</a>. I don’t even care that this post is 16 years old. Somebody might accidentally try to read it!</p>
<p>I touched up what I could without destroying the flow, but things would look much different if I wrote this post today.</p>
</blockquote>
<p>Thanks to everybody for the positive feedback on the first MIRE. I still have your attention, so I’ll move on to my next exercise. This one is a little more involved than the first, but bear with me - the results should be worth it.</p>
<h2 id="the-problem">The Problem</h2>
<p>I have been a big fan of Celtic knotwork for many years, and have been drawing it myself as an occasional distraction for most of that time. I don’t think I’m very good at it, but I’ve occasionally made myself proud. Heck, I’ve even designed a couple tattoos for folks, making a few bucks in the process. Any time you can profit from your hobbies is good. Any time somebody likes your work so much that they want it embedded in their skin with a sharp needle is also good.</p>
<p>My preferred technique has always been manual and therefore labor-intensive. You lay out a grid, block out your major areas, draw your knotwork paths, and then embellish a little for personality. It’s simple and repetitive, and I like it that way. There’s a meditative element to such things which can’t be ignored. Still, I’m here to write a programming exercise, not to wax eloquently about the virtues of being hunched over a sheet of paper for hours at a time.</p>
<p>Any time a geek hears the phrase &ldquo;simple and repetitive,&rdquo; the geek’s mind turns to ways of automating the task being described. Well, <em>this</em> geek’s mind does. I wonder how hard it would be to write a <a href="/card/ruby/">Ruby</a> program which could, given some dimensions by the user, create a simple knotwork panel of the desired size and then write that panel to an image file?</p>
<h2 id="finding-a-solution">Finding a Solution</h2>
<p>As it turns out, somebody else has already solved a fair chunk of the problem. Andy Sloss’s book <a href="https://www.goodreads.com/book/show/2762386-how-to-draw-celtic-knotwork">How to Draw Celtic Knotwork: A Practical Guide</a> provides a detailed overview of his approach, which essentially boils down to arranging a set of image tiles on a grid so that the end result looks like an attractive knotwork image. He’s even gone so far as to provide each of the tiles that can be used in his system.</p>
<h3 id="the-plan">The Plan</h3>
<p>This project is a little more complicated than the last MIRE, so I want to step through it a little more carefully. Actually, it’s not more complicated. It’s just that less of the work has already been done for me. Instead of jumping right into creating bitmap images on the fly, I’m going to use <a href="http://en.wikipedia.org/wiki/ASCII_art">ASCII art</a> to create my knotwork at first.</p>
<p>Let’s step through what we’ll be doing later in code. Here is a collection of image tiles arranged in a grid.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >. . . . x x x x x  x x . . . . . x x  x x x x x . . . .
. . . . x . . . .  . . x x . x x . .  . . . . x . . . .
. . . . x . . . x  . . . . x . . . .  x . . . x . . . .
. . . . x . . x .  x x . . . x . x x  . x . . x . . . .
. . . . x . . x .  . . x . . . x . .  . x . . x . . . .
. . . . . x . . x  x . . . x . . . x  x . . x . . . . .
. . . . . x . . x  . . . x . x . . x  . . . x . . . . .
. . . . . . x x .  . . x . . . x x .  . . x . . . . . .

. . . . . . x . .  . . x . . . x . .  . x x . . . . . .
. . . . . x . . .  . x . x . x . . .  x . . x . . . . .
. . . . . x . . .  x . . . x . . . x  x . . x . . . . .
. . . . x . . . x  . x . . . x . x .  . x . . x . . . .
. . . . x . . x .  . . x . . . x . .  . x . . x . . . .
. . . . x . . x .  . x . x . . . x .  . x . . x . . . .
. . . . . x . . x  x . . . x . . . x  x . . x . . . . .
. . . . . x . . x  . . . x . x . x .  . . . x . . . . .
. . . . . . x x .  . . x . . . x . .  . . x . . . . . .

. . . . . . x . .  . x x . . . x . .  . x x . . . . . .
. . . . . x . . .  x . . x . x . . .  x . . x . . . . .
. . . . . x . . x  x . . . x . . . x  x . . x . . . . .
. . . . x . . x .  . x . . . x . x .  . x . . x . . . .
. . . . x . . x .  . . x . . . x . .  . x . . x . . . .
. . . . x . . . x  x x . x . . . x x  x . . . x . . . .
. . . . x . . . .  . . . . x . . . .  . . . . x . . . .
. . . . x . . . .  . . x x . x x . .  . . . . x . . . .
. . . . x x x x x  x x . . . . . x x  x x x x x . . . .</code></pre>
</figure><p>Squish them together into one big image, and guess what? We have a knot!</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >. . . . x x x x x x x . . . . . x x x x x x x . . . .
. . . . x . . . . . . x x . x x . . . . . . x . . . .
. . . . x . . . x . . . . x . . . . x . . . x . . . .
. . . . x . . x . x x . . . x . x x . x . . x . . . .
. . . . x . . x . . . x . . . x . . . x . . x . . . .
. . . . . x . . x x . . . x . . . x x . . x . . . . .
. . . . . x . . x . . . x . x . . x . . . x . . . . .
. . . . . . x x . . . x . . . x x . . . x . . . . . .
. . . . . . x . . . . x . . . x . . . x x . . . . . .
. . . . . x . . . . x . x . x . . . x . . x . . . . .
. . . . . x . . . x . . . x . . . x x . . x . . . . .
. . . . x . . . x . x . . . x . x . . x . . x . . . .
. . . . x . . x . . . x . . . x . . . x . . x . . . .
. . . . x . . x . . x . x . . . x . . x . . x . . . .
. . . . . x . . x x . . . x . . . x x . . x . . . . .
. . . . . x . . x . . . x . x . x . . . . x . . . . .
. . . . . . x x . . . x . . . x . . . . x . . . . . .
. . . . . . x . . . x x . . . x . . . x x . . . . . .
. . . . . x . . . x . . x . x . . . x . . x . . . . .
. . . . . x . . x x . . . x . . . x x . . x . . . . .
. . . . x . . x . . x . . . x . x . . x . . x . . . .
. . . . x . . x . . . x . . . x . . . x . . x . . . .
. . . . x . . . x x x . x . . . x x x . . . x . . . .
. . . . x . . . . . . . . x . . . . . . . . x . . . .
. . . . x . . . . . . x x . x x . . . . . . x . . . .
. . . . x x x x x x x . . . . . x x x x x x x . . . .</code></pre>
</figure><p>You don’t quite see it? Well, squint a little and tilt your head a bit. Still nothing? Just bear with me. We will get to actual pictures soon, I promise.</p>
<p>Okay, let’s find a way to automate this process.</p>
<h3 id="turning-the-plan-into-code">Turning the Plan Into Code</h3>
<p>This works, doesn’t it?</p>
<p><strong><code>print-knot.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">knot</span> <span class="o">=</span><span class="s">&lt;&lt;HERE
</span></span></span><span class="line"><span class="cl"><span class="s"></span>     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="n">knot</span></span></span></code></pre>
</figure><p>I know, &ldquo;Ha ha, very funny. You are so clever and witty. We are being sarcastic, if you didn’t guess, Mister Writer.&rdquo; I know that this is cheating, but it <em>works</em> doesn’t it? This would be good enough if all you wanted was some sort of ASCII art knot.</p>
<p>Then again, Laziness taken too far does become plain old laziness. This isn’t good enough for any of us. The idea is to be able to draw a knotwork panel of any size that we want.</p>
<p>Let’s look at the nouns we’ve used when describing the problem:</p>
<blockquote>
<p>We want to create a knotwork panel by arranging tiles on a grid, then merging them into a single image.</p>
</blockquote>
<ul>
<li>knotwork panel - <em>I threw the adjective in for a little descriptiveness</em></li>
<li>grid</li>
<li>tile</li>
<li>image</li>
</ul>
<p>I think these nouns make a good start for the class names in our program.</p>
<p><a href="http://www.zenspider.com/">Zenspider</a> once described a style of commenting classes that was like the classes were describing themselves in the first person. I don’t know why, but I really liked that concept. I’ve stuck with it in a lot of my own code.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># I am a single small section of a knotwork image. I know about my</span>
</span></span><span class="line"><span class="cl"><span class="c1"># dimensions, and can describe myself on a pixel-by-pixel basis.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Tile</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I am a 2-dimensional collection of tiles. I know where each of my Tiles are</span>
</span></span><span class="line"><span class="cl"><span class="n">located</span><span class="p">,</span> <span class="ow">and</span> <span class="n">can</span> <span class="n">describe</span> <span class="n">them</span> <span class="n">as</span> <span class="k">if</span> <span class="n">they</span> <span class="n">were</span> <span class="n">a</span> <span class="n">single</span> <span class="n">large</span> <span class="n">entity</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Grid</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I am a lovely Celtic knotwork panel. I know my dimensions, and can output myself</span>
</span></span><span class="line"><span class="cl"><span class="c1"># as ASCII art.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KnotworkPanel</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I know how to create a graphical representation of a KnotworkPanel</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Image</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Now I know each of the major objects in this program, and the duties that they must fill. It’s time to blaze through the highlights of writing the code. For convenience, we can put the application code and the testing code in the same file for now.</p>
<h3 id="building-a-tile">Building a Tile</h3>
<p>The simplest element of our description is the Tile. I decided that a Tile would be a two dimensional chunk of characters that would let you set or get any point in that space. Remember that this isn’t the only way we could have done things. You could also describe the lines and curves in the tile, or the colors, transparency, and whatever else the crazy kids are coming up with these days. This is my first drawing program, though, and I want to keep it as simple as I can. So I’m going with the bitmap idea. The tile images in the Sloss book are provided in different sizes. Let’s go with 9x9. It’s small and manageable without being too small to see.</p>
<blockquote>
<p><strong>2021-08-21</strong></p>
<p>Unless it&rsquo;s 2021, when you have a big monitor and old eyes.</p>
<p><em>squints and continues editing</em></p>
</blockquote>
<p><strong><code>knotwork/tile.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="no">TILE_SIZE</span> <span class="o">=</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I am a single small section of a knotwork image. I know about my</span>
</span></span><span class="line"><span class="cl"><span class="c1"># dimensions, and can describe myself on a pixel-by-pixel basis.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Tile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">str</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">TILE_SIZE</span><span class="p">)</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">TILE_SIZE</span><span class="p">)</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">str</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="n">set_from_string</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="vi">@pixels</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">alias</span> <span class="n">is_set?</span> <span class="n">at</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kp">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">unset</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">self</span><span class="o">.</span><span class="n">set</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="kp">nil</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">set_from_string</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="p">,</span> <span class="n">row</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">pixel</span><span class="p">,</span> <span class="n">col</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">set</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_s</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">str</span> <span class="o">+=</span> <span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="n">row</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">pixel</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">pixel</span> <span class="o">||=</span> <span class="s2">&#34; &#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">str</span> <span class="o">+=</span> <span class="s2">&#34;</span><span class="si">#{</span><span class="n">pixel</span><span class="si">}</span><span class="s2">|&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">str</span> <span class="o">+=</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">str</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>I&rsquo;ll write tests with the rock-solid <a href="http://docs.seattlerb.org/minitest/">Minitest</a> testing library.</p>
<p><strong><code>tests/test_tile.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;minitest/autorun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;../knotwork/tile.rb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestTile</span> <span class="o">&lt;</span> <span class="no">Minitest</span><span class="o">::</span><span class="no">Test</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">setup</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@tile</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_pixels</span>
</span></span><span class="line"><span class="cl">    <span class="n">refute</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;By default, any pixel in a Tile is blank&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;Use Tile#set(row, col) to set a pixel at coordinates (row, col)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;A pixel (row, col) is set after Tile#set(row, col) has been called&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="vi">@tile</span><span class="o">.</span><span class="n">unset</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">refute</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;An unset pixel has no set value&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="vi">@tile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">refute</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;Setting one pixel has no effect on other pixels in a Tile&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;Tile remembers the set status of each pixel in its confines.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_set_from_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">source_string</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">set_from_string</span><span class="p">(</span><span class="n">source_string</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;You can use ASCII art strings to set the pixels in a Tile&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;A Tile remembers the value assigned, if given, during Tile#set(row, col, val)&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>This is — <em>2020 note: my early attempt at</em> — <a href="http://www.agiledata.org/essays/tdd.html">Test-Driven Development</a>, where you write the tests for your code as you are writing the code itself. A little <em>before</em> the code itself, actually. TDD is useful for any non-trivial programming task. You have the tests there right from the beginning to describe what your classes are supposed to be able to do. Because TDD is based on lots of tiny changes being applied rapidly over time, I decided it would be tedious to describe that process to you at each little step. Instead, we stop and take a snapshot as we get each major stage accomplished. Like that code sample up there. It’s really where I’m at right about now. See: there’s the class definition, a couple of very basic accessors, and the ability to set all the pixels of a Tile at once from a String.</p>
<p>Now that the Tile is pretty much doing everything I want it to, let’s move on to the Grid.</p>
<h3 id="putting-the-tile-in-a-grid">Putting the Tile in a Grid</h3>
<p>I want to hurry on to making pictures, so let’s rush through the Grid part.</p>
<p>That’s easy enough, actually. We only need to be able to do a few simple things with a Grid:</p>
<ul>
<li>Create it at a set size.</li>
<li>Add a Tile somewhere in the Grid.</li>
<li>Read each individual pixel of the Grid transparently.</li>
</ul>
<p>And here’s the code.</p>
<p><strong><code>knotwork/grid.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># I am an arranged collection of Tiles. I know how to add and remove</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Tiles along a 2-d grid, and can also present myself as if I were a single</span>
</span></span><span class="line"><span class="cl"><span class="c1"># large Tile.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;tile&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Grid</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@tile_size</span> <span class="o">=</span> <span class="no">TILE_SIZE</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@rows</span>      <span class="o">=</span> <span class="n">rows</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@columns</span>   <span class="o">=</span> <span class="n">columns</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span>    <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="vi">@tile_size</span><span class="p">)</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">columns</span><span class="o">*</span><span class="vi">@tile_size</span><span class="p">)</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">set_tile</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">tile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pixel_origin_x</span> <span class="o">=</span> <span class="n">row</span> <span class="o">*</span> <span class="vi">@tile_size</span>
</span></span><span class="line"><span class="cl">    <span class="n">pixel_origin_y</span> <span class="o">=</span> <span class="n">column</span> <span class="o">*</span> <span class="vi">@tile_size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="vi">@tile_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">tile_x</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">=</span> <span class="n">pixel_origin_x</span> <span class="o">+</span> <span class="n">tile_x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="vi">@tile_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">tile_y</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">pixel_origin_y</span> <span class="o">+</span> <span class="n">tile_y</span>
</span></span><span class="line"><span class="cl">        <span class="vi">@pixels</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">]</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">at</span> <span class="n">tile_x</span><span class="p">,</span> <span class="n">tile_y</span>
</span></span><span class="line"><span class="cl">      <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">at</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="vi">@pixels</span><span class="o">[</span><span class="n">row</span><span class="o">][</span><span class="n">column</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_s</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">str</span> <span class="o">+=</span> <span class="n">row</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">str</span><span class="o">.</span><span class="n">chomp</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p><strong><code>tests/test_grid.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;minitest/autorun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;../knotwork/grid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestGrid</span> <span class="o">&lt;</span> <span class="no">Minitest</span><span class="o">::</span><span class="no">Test</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">setup</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@source_string</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_simple_grid</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span> <span class="o">=</span> <span class="no">Grid</span><span class="o">.</span><span class="n">new</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">tile</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="vi">@source_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="s2">&#34;x&#34;</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;pixel_at fetches contents from pixel coordinates&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="vi">@source_string</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">to_s</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_large_grid</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span> <span class="o">=</span> <span class="no">Grid</span><span class="o">.</span><span class="n">new</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">tile1</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="vi">@source_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">tile2</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="vi">@source_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile1</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tile2</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="s2">&#34;x&#34;</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;pixel_at fetches from anywhere in the Grid.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">expected_output</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="n">expected_output</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">to_s</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>There, that’s another fifteen minutes of coding done. Yes, the combination of TDD and Ruby makes it about this easy to write a program.</p>
<h3 id="using-the-grid-to-make-a-knotworkpanel">Using the Grid to Make a KnotworkPanel</h3>
<p>Things get a little more complex now, because we’re on to creating a KnotworkPanel. Every KnotworkPanel uses a specific set of predefined tiles — <em>thanks again to Andy Sloss for going to the trouble of defining them</em> — which I will store as class variables. I would probably store them in a different file if I wanted to include <em>every</em> Tile defined in Sloss’s book, but that’s more than I want to chew on today.</p>
<p>Certain Tiles must go in certain locations of the KnotworkPanel’s Grid, such as the corners and edges, and we have to remember this in our tests. Ah, let’s just cut and paste the source strings and squish them together so that they look like what we’re aiming for. That’s probably the easiest test for now.</p>
<p>For a while, my problem was that I was copying and pasting incorrectly. Don’t ask me how I pull this stuff off. I’m just special, I guess. The test results would end up spewing out &ldquo;Expected &ldquo;… a really long chain of <code>x</code> and <code>.</code> characters, &quot; but got &quot; … a really long chain of <code>x</code> and <code>.</code> characters, almost identical to the first chain. My solution? Test each row of output, that way I see exactly which line was one character off.</p>
<p><strong><code>knotwork/knotwork_panel.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;tile&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;grid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «define-tile-maps»</span>
</span></span><span class="line"><span class="cl"><span class="c1"># «define-knotwork-panel-class»</span>
</span></span><span class="line"><span class="cl"><span class="o">----</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">define</span><span class="o">-</span><span class="n">tile</span><span class="o">-</span><span class="n">maps</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span><span class="n">source</span><span class="p">,</span><span class="n">ruby</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">----</span>
</span></span><span class="line"><span class="cl"><span class="no">NW_CORNER</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">N_EDGE</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">NE_CORNER</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">W_EDGE</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">CENTER</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">E_EDGE</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">SW_CORNER</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">S_EDGE</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">SE_CORNER</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span></span></span></code></pre>
</figure><p><strong><code>define-knotwork-panel-class</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># I am a lovely Celtic knotwork panel. I know my dimensions, and can output</span>
</span></span><span class="line"><span class="cl"><span class="c1"># myself as ASCII art.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KnotworkPanel</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@top_left</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">NW_CORNER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@top</span>      <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">N_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@topright</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">NE_CORNER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@left</span>     <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">W_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@center</span>   <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">CENTER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@right</span>    <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">E_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@bot_left</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">SW_CORNER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@bottom</span>   <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">S_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@botright</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">SE_CORNER</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@row_size</span> <span class="o">=</span> <span class="n">rows</span> <span class="o">+</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@col_size</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">+</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span> <span class="o">=</span> <span class="no">Grid</span><span class="o">.</span><span class="n">new</span> <span class="vi">@row_size</span><span class="p">,</span> <span class="vi">@col_size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Set the top row.</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="vc">@@top_left</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vc">@@topright</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="vc">@@top</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Set the center rows.</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="vc">@@left</span>
</span></span><span class="line"><span class="cl">      <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="n">i</span><span class="p">,</span> <span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vc">@@right</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">j</span><span class="o">|</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="vc">@@center</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Set the bottom row</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="vc">@@bot_left</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vc">@@botright</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="vc">@@bottom</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_aa</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">to_s</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p><strong><code>tests/test_knotwork_panel.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;minitest/autorun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;../knotwork/knotwork_panel&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestKnotworkPanel</span> <span class="o">&lt;</span> <span class="no">Minitest</span><span class="o">::</span><span class="no">Test</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_ascii</span>
</span></span><span class="line"><span class="cl">    <span class="n">panel</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected_lines</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span><span class="o">.</span><span class="n">split</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">output_lines</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">to_aa</span><span class="o">.</span><span class="n">split</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected_lines</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">assert_equal</span> <span class="n">line</span><span class="p">,</span> <span class="n">output_lines</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;line </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2"> doesn&#39;t match&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_large_panels</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">output_lines</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_aa</span><span class="o">.</span><span class="n">split</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">assert_equal</span> <span class="n">line</span><span class="p">,</span> <span class="n">output_lines</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;line </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2"> doesn&#39;t match&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Yeah, that works. Let’s move on.</p>
<blockquote>
<p><strong>NOTE</strong></p>
<p>Wait. This is me from a few days in the future, editing this page.
KnotworkPanel’s initializer kinda bugs me. It’s fine for what it does, but how’s
the average person supposed to know that <code>KnotworkPanel.new(1,2)</code> actually
creates a KnotworkPanel with dimensions of 3x5, including the border?</p>
<p>Really, this is why you need some person to represent the customer or a user
besides yourself whenever you want to write code for other people to use. I
could change the initializer, but I really want to get the article out so the
geeks of the world can point and laugh at my mistakes.</p>
<p>For now, just remember that the dimensions sent to the initializer don’t include
the bordering tiles. So if you want a 5x5 panel, you’ll have to call
<code>KnotworkPanel.new(3, 3)</code>. Man, that’s ugly. Let’s make fixing that an exercise
at the end of the article, okay?</p>
</blockquote>
<h3 id="creating-an-image-of-the-knotworkpanel">Creating an Image of the KnotworkPanel</h3>
<p>I bet you feel really cheated by now. I’ve been going on for all this time about Celtic knotwork and drawing pictures with the computer. All you’ve seen is a bunch of dots and crosses that kind of look like a picture if you go cross-eyed for a second. You can cheer up, folks, because you’ve finished the boring part. Now we want to make a real live picture!</p>
<p>But how are we going to do it? You know that I’m <em>not</em> about to go making my own image creation library for a little project like this &ndash; or any other project, if I can help it.</p>
<p>No need. The <a href="https://rmagick.github.io/">RMagick</a> library wraps around <a href="https://www.imagemagick.org">ImageMagick</a> for all the image generating power I need today.</p>
<p><strong><code>knotwork-image-logic</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rmagick&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kp">include</span> <span class="no">Magick</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KnotworkPanel</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_image</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">filename</span> <span class="o">=</span> <span class="s2">&#34;panel-</span><span class="si">#{</span><span class="vi">@row_size</span><span class="si">}</span><span class="s2">x</span><span class="si">#{</span><span class="vi">@col_size</span><span class="si">}</span><span class="s2">.png&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">max_x</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="vi">@row_size</span>
</span></span><span class="line"><span class="cl">    <span class="n">max_y</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="vi">@col_size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="no">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span> <span class="p">{</span> <span class="nb">self</span><span class="o">.</span><span class="n">background_color</span> <span class="o">=</span> <span class="s2">&#34;white&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="n">max_y</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">y</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="n">max_x</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">pixel</span> <span class="o">=</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pixel</span> <span class="o">==</span> <span class="s2">&#34;x&#34;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">          <span class="n">image</span><span class="o">.</span><span class="n">pixel_color</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&#34;black&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">      <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><blockquote>
<p><strong>2020-08-01</strong></p>
<p>Looks like I skipped tests for <code>Knotwork#to_image</code> as well. And wasn&rsquo;t I saying something about &ldquo;image&rdquo; being one of the nouns that should be a class? Whatever happened to that?</p>
</blockquote>
<p>Time to make an image.</p>
<p><strong><code>draw-knot.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;./knotwork/knotwork_panel.rb&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «knotwork-image-logic»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">panel</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">panel</span><span class="o">.</span><span class="n">to_image</span><span class="p">()</span></span></span></code></pre>
</figure><p>Thanks to all the work we did building Tiles and Grids and ASCII art KnotworkPanels, we only need to add a few lines to allow KnotworkPanels to create a nice black and white PNG image file. Here’s what we get::</p>
<p><figure>
    <img src="/attachments/img/2004/panel.png" alt="10x20 panel"/></figure></p>
<p>Cool, eh?</p>
<h3 id="building-knotworkpanels-of-any-size">Building KnotworkPanels of Any Size</h3>
<p>Now the program does what I want it to. But if I hand this script off to somebody else and say &ldquo;This program will make knotwork panels of any size,&rdquo; one of their first questions will be how to set the size. &ldquo;Go in and edit the code&rdquo; won’t cut it. Let’s haul out our trusty <a href="http://www.ruby-doc.org/stdlib/libdoc/optparse/rdoc/classes/OptionParser.html">OptParse</a> library again.</p>
<p><strong><code>main-with-option-parser</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span>
</span></span><span class="line"><span class="cl">  <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">opts</span> <span class="o">=</span> <span class="no">OptionParser</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">opts</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">banner</span> <span class="o">=</span> <span class="s2">&#34;Usage </span><span class="si">#{</span><span class="vg">$0</span><span class="si">}</span><span class="s2"> |opts|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">separator</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">separator</span> <span class="s2">&#34;Specific Options&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&#34;-r&#34;</span><span class="p">,</span> <span class="s2">&#34;--rows [ROWS]&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Number of rows for this panel (default 1)&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">rows</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">to_i</span>
</span></span><span class="line"><span class="cl">      <span class="n">columns</span> <span class="o">=</span> <span class="n">rows</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&#34;-c&#34;</span><span class="p">,</span> <span class="s2">&#34;--columns [COLUMNS]&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Number of columns for this panel (default ROWS)&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">columns</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_i</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">on_tail</span><span class="p">(</span><span class="s2">&#34;-h&#34;</span><span class="p">,</span> <span class="s2">&#34;--help&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="s2">&#34;Show this message&#34;</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="n">opts</span>
</span></span><span class="line"><span class="cl">      <span class="nb">exit</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">opts</span><span class="o">.</span><span class="n">parse!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">panel</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">panel</span><span class="o">.</span><span class="n">to_image</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Running it with the default should result in a 3x3 panel:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby knotworkpanel.rb</code></pre>
</figure><p><figure>
    <img src="/attachments/img/2004/panel-3x3.png" alt="3x3 panel"/></figure></p>
<p>Setting <code>rows</code> to 2 results in a 4x4 panel.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby knotworkpanel.rb --rows 2</code></pre>
</figure><p><figure>
    <img src="/attachments/img/2004/panel-4x4.png" alt="4x4 panel"/></figure></p>
<blockquote>
<p><strong>NOTE</strong></p>
<p>Me from the immediate future says &ldquo;See? This is what I was talking about. You say
&lsquo;2 rows&rsquo;, and you get a 4x4 square? How do you think people are going to
react? Man, I need more coffee.&rdquo;</p>
</blockquote>
<p>Ignoring me from the future for today, let’s see what happens when we try to make a nice <em>big</em> KnotworkPanel.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby knotworkpanel.rb --rows 98 --columns 73</code></pre>
</figure><p>Hmm … took a few seconds this time. If I cared about performance, I might go in and see where this could be tightened up. I don’t care about performance today, though. I care about results. And the results aren’t too bad.</p>
<blockquote>
<p><strong>2021-08-21</strong></p>
<p>oh god my eyes. The knots are so tiny on a modern monitor, and there are so   many of them. I pulled the link to the big panel out of the main text so it won&rsquo;t catch anybody unawares. If you have any visually-triggered issues maybe don&rsquo;t click.</p>
<p><a href="attachments/img/2004/panel-100x75.png">you have been warned</a></p>
</blockquote>
<h3 id="cleaning-up">Cleaning Up</h3>
<p>Okay, it’s done! That is to say, it does all the things I want it to for now. There’s a <em>lot</em> more stuff that I would like to do with this program, but it’s important to know when to stop and take a breath. Let’s just go back and clean up the code a little bit. Not actually change any functionality or user interface, so Me From The Future is just going to have to wait. I only want to make it easier to read the code that I have already written.</p>
<p><strong><code>knotwork.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;./knotwork/knotwork_panel.rb&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «knotwork-image-logic»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «main-with-option-parser»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">main</span></span></span></code></pre>
</figure><h2 id="conclusion">Conclusion</h2>
<p>Okay, so that’s about it. We’ve gone from an idea to a program that creates png formatted images of Celtic-style knotwork panels. Not bad at all. There are a lot of other things we could do with this program, though.</p>
<p>Here are a few ideas:</p>
<ul>
<li>Come up with some good ideas for unit testing the image generation code. Then send them to me :smile:</li>
<li>Antialias the lines for a smoother effect.</li>
<li>Add color.</li>
<li>Incorporate the rest of the patterns detailed in the Andy Sloss book.</li>
<li>Add the ability to make complex panels.</li>
<li>Add the ability to scale pattern panels to any size.</li>
<li>Make Me From The Future happy by fine-tuning the KnotworkPanel initializer and/or the OptParse options so that the user gets a 3x3 panel when they request a 3x3 panel. Oh, but what happens when the user requests a 1x1 panel? I guess you’ll have to figure that out.</li>
<li>Done already? Andy Sloss also wrote a book using similar techniques for drawing key patterns. Go write that program, and merge it with this one for a lean, mean, Celtic-art producing machine.</li>
</ul>
]]></content:encoded>
</item>
<item>
  <title>Post: Look at the Latest Fark Headlines</title>
  <link>https://randomgeekery.org/post/2004/09/look-at-the-latest-fark-headlines/</link>
  <pubDate>Fri, 17 Sep 2004 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/09/look-at-the-latest-fark-headlines/</guid>
  <description>The Problem I want to look at the Fark headlines without opening a browser. Why? I dunno, maybe I just want to see what’s new since the last time I looked, without being distracted by the site clutter.
Now, I could just turn off images and go to the site, and that would work fine. Actually, it would work quite well. No need for this article, then. I’m off for some coffee …</description>
   <category>post</category> 
   <category>post</category> 
   <category>ruby</category>  <category>learn</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<h2 id="the-problem">The Problem</h2>
<p>I want to look at the <a href="http://fark.com/">Fark</a> headlines without opening a browser. Why? I dunno, maybe I just want to see what’s new since the last time I looked, without being distracted by the site clutter.</p>
<p>Now, I could just turn off images and go to the site, and that would work fine. Actually, it would work quite well. No need for this article, then. I’m off for some coffee …</p>
<p>What? I <em>have</em> to write something in here about <a href="/card/ruby/">Ruby</a>? … okay.</p>
<p>ahem.</p>
<p>I want to look at the <a href="http://fark.com/">Fark</a> headlines without opening a browser. Why? Well, as it so happens, I am logged into a machine via <code>ssh</code>, and using <code>elinks</code> to load the page will result in a lot of extra clutter from text versions of ads which obscure the headlines. I’m just interested in seeing what interesting, scary, or amusing things have been posted on Fark since the last time I checked.</p>
<h2 id="finding-a-solution">Finding a Solution</h2>
<p>Well, we could always just dump the Fark page to the console:</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">headlines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;http://www.fark.com/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="n">headlines</span></span></span></code></pre>
</figure><p>Three lines of code and we have output.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb
⋮
&lt;!-- START copyright_html() --&gt;
&lt;div id=&#34;footer&#34;&gt;
&lt;span class=&#34;boldy&#34;&gt;&lt;a target=&#34;_top&#34; href=&#34;http://www.fark.com/nomirror/&#34;&gt;&lt;/a&gt;\
Copyright &amp;copy; 1999-2009 Fark, Inc&lt;/span&gt;&lt;br&gt;
&lt;strong&gt;Last updated: Mon Mar  9 16:28:19 2009&lt;/strong&gt;&lt;br&gt;
&lt;a target=&#34;_top&#34; href=&#34;http://www.fark.com/cgi/feedback.pl&#34;&gt;Contact us&lt;/a&gt; | &lt;\
a target=&#34;_top&#34; href=&#34;http://www.fark.com/cgi/feedback.pl?type=error&#34;&gt;Report a\
bug/error msg&lt;/a&gt;&lt;br&gt;
&lt;a target=&#34;_top&#34; href=&#34;http://www.fark.com/farq/legal.shtml&#34;&gt;Terms of service/\
legal/privacy policy&lt;/a&gt;
&lt;br&gt;
&lt;div class=&#34;finalfootnote&#34;&gt;&lt;script type=&#34;text/javascript&#34;&gt;
//&lt;![CDATA[
document.write(&#39;&lt;&#39;&#43;&#39;img src=&#34;http://www.fark.com/cgi/ll.pl?l=H384ABPoSz-uDukni\
hQDAVhlkEgde6Pxu7ZO_uxPBp5SfD&amp;amp;v=&#39;); var fw=(window.innerWidth) ? window.in\
nerWidth : document.body.offsetWidth; var fh=(window.innerHeight) ? window.inn\
erHeight : document.body.offsetHeight; var fc=window.screen.colorDepth; docume\
nt.writeln(((fh*8192)&#43;fw)&#43;&#39;&amp;amp;c=&#39;&#43;fc&#43;&#39;&#34; width=&#34;4&#34; height=&#34;1&#34; alt=&#34;&#34;&#39;&#43;&#39;&gt;&#39;);
//]]&gt;&lt;/script&gt;&lt;noscript&gt;&lt;img src=&#34;http://www.fark.com/cgi/ll.pl?l=H384ABPoSz-u\
DuknihQDAVhlkEgde6Pxu7ZO_uxPBp5SfD&amp;amp;v=0&#34; width=&#34;4&#34; height=&#34;1&#34; alt=&#34;&#34;&gt;&lt;/nosc\
ript&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;!-- END copyright_html() --&gt;
&lt;/div&gt; &lt;!-- siteContainer --&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</figure><p>But running this doesn’t quite get the result I was looking for. I just want the headlines, and I want them without the HTML, thank you very much.</p>
<p>Fark and a lot of other news sites make <a href="https://blogging.im/RSS">RSS</a> feeds available. These are special XML files containing mainly — you guessed it, the headlines, without the HTML, you’re very welcome.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">headlines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="n">headlines</span></span></span></code></pre>
</figure><p>This is a little closer to what we want.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby fark.rb
⋮
&lt;item&gt;
 &lt;title&gt;&amp;#34;Hindsight isn&amp;#39;t only 20/20, it&amp;#39;s usually also sober&amp;#34; [Dumbass]&lt;/title&gt;
 &lt;description&gt;&lt;![CDATA[Atlanta Journal Constitution]]&gt;&lt;/description&gt;
 &lt;link&gt;http://www.fark.com/cgi/comments.pl?IDLink=4255950&lt;/link&gt;
 &lt;pubDate&gt;Mon, 09 Mar 2009 02:05:43 EDT&lt;/pubDate&gt;
 &lt;guid isPermaLink=&#34;false&#34;&gt;http://www.fark.com/cgi/go.pl?i=4255950&lt;/guid&gt;
&lt;/item&gt;
&lt;/channel&gt;
&lt;/rss&gt;</code></pre>
</figure><p>Now I get the RSS file dumped to the console. At least the story headlines are little easier to find. To get the behavior I want, though, we’re going to need to chop out the bits we don’t care about and get straight to the headlines. This task is straightforward in Ruby, thanks to the <a href="http://ruby-doc.org/stdlib/libdoc/rss/rdoc/index.html">RSS</a> library. The RSS library has recently been made an official part of the standard libs, which makes a lot of this exercise much easier.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rss&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rss_url</span> <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">document</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rss_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span> <span class="o">=</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="nb">puts</span> <span class="n">item</span><span class="o">.</span><span class="n">title</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Okay, now what does this look like?</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb
Worried about being the washed-up former high school football star while \
those nerds you picked on become millionaires later in life? Well, good n\
ews [Interesting]
State mental hospital drops off severely ill woman at bus station to make\
it home by herself. Since this is Fark, you can assume she didn&#39;t make it\
[Sad]
Professional coffee taster&#39;s tongue insured for $14 million. The man&#39;s to\
ngue works magic on the bean [Amusing]
In celebration of his 69th birthday tomorrow, Chuck Norris will randomly \
select one lucky child to be thrown into the sun [Hero]
Moving pot plants to an undisclosed location to deter would-be burglars i\
s a GREAT idea. Just don&#39;t do it using an open-bed pickup truck. Police m\
ight see you [Florida]
Nothing solves an $8 billion dollar deficit like a good old fashioned bak\
e sale [Stupid]
Yet another indicator of America&#39;s continuing decline: pediatricians now \
recommend that children between the ages of 2 and 10 be routinely screene\
d for heart disease [Sad]
Computer glitch caused Austrailian airliner to plunge 1,000 feet and the \
toilets to flush counterclockwise [Scary]
This year&#39;s Maxwell Smart Special Achievement Award goes to the US Triden\
t missile program, for keeping the composition of a key material so secre\
t that no one knows how to make it anymore [Fail]
Unique portrait of William Shakespeare reveals much about the notorious b\
ard, such as the stunning realization that he looks like Russell Brand [I\
nteresting]
Just what the filthy rich need -- a place to super-poke their filthy rich\
friends [Dumbass]
Man/Boy love group NAMBLA puts $10,000 hit on New York&#39;s Attorney General\
; because decades in jail is so worth $10G [Asinine]
Christian salt, contraceptive robberies, and a wallet full of teeth: Fark\
&#39;s Headlines of the Week 3/1 to 3/7 [FarkBlog]
⋮</code></pre>
</figure><p>This is even better still, but that’s an awful lot of headlines. How about just the most recent ones? How about the last 10?</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rss&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rss_url</span> <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">limit</span> <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">document</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rss_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span> <span class="o">=</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">  <span class="nb">puts</span> <span class="n">item</span><span class="o">.</span><span class="n">title</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>What does it look like now?</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb
Today&#39;s moral outrage comes from Geneva, Switzerland, where a known prostitut\
e activist was buried in the same cemetery as John Calvin [Strange]
Meghan McCain calls Ann Coulter &#34;offensive&#34; and &#34;insulting,&#34; adding &#34;are you \
going to finish those fries?&#34; [Interesting]
Worried about being the washed-up former high school football star while thos\
e nerds you picked on become millionaires later in life? Well, good news [Int\
eresting]
State mental hospital drops off severely ill woman at bus station to make it \
home by herself. Since this is Fark, you can assume she didn&#39;t make it [Sad]
Professional coffee taster&#39;s tongue insured for $14 million. The man&#39;s tongue\
works magic on the bean [Amusing]
In celebration of his 69th birthday tomorrow, Chuck Norris will randomly sele\
ct one lucky child to be thrown into the sun [Hero]
Moving pot plants to an undisclosed location to deter would-be burglars is a \
GREAT idea. Just don&#39;t do it using an open-bed pickup truck. Police might see\
you [Florida]
Nothing solves an $8 billion dollar deficit like a good old fashioned bake sa\
le [Stupid]
Yet another indicator of America&#39;s continuing decline: pediatricians now reco\
mmend that children between the ages of 2 and 10 be routinely screened for he\
art disease [Sad]
Computer glitch caused Austrailian airliner to plunge 1,000 feet and the toil\
ets to flush counterclockwise [Scary]</code></pre>
</figure><p>Now we’ve got it down to the freshest 10, but each item is still filling up a lot of space. One way to cut down the length of each line is to split each headline into multiple lines. Let’s start by cutting the category and title into two separate lines:</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rss&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rss_url</span>       <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">limit</span>         <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">title_pattern</span> <span class="o">=</span> <span class="no">Regexp</span><span class="o">.</span><span class="n">new</span> <span class="sr">%r{\[(.+?)\]\s(.+)$}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">document</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rss_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span> <span class="o">=</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">  <span class="n">title_match</span> <span class="o">=</span> <span class="n">title_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">title_match</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">puts</span> <span class="n">title_match</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">upcase</span><span class="p">,</span> <span class="n">title_match</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>It’s a lot easier for me to read the output now.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb
INTERESTING
Research shows that older fathers tends to has more kids who is dumb
FLORIDA
If you want to avoid suspicion of driving under the influence, the first \
step would be to make sure you&#39;re driving on a full set of tires
INTERESTING
Vatican claims washing machine is most liberating 20th century invention \
for women. Sybian didn&#39;t even make the list
STRANGE
Today&#39;s moral outrage comes from Geneva, Switzerland, where a known prost\
itute activist was buried in the same cemetery as John Calvin
INTERESTING
Meghan McCain calls Ann Coulter &#34;offensive&#34; and &#34;insulting,&#34; adding &#34;are \
you going to finish those fries?&#34;
INTERESTING
Worried about being the washed-up former high school football star while \
those nerds you picked on become millionaires later in life? Well, good n\
ews
SAD
State mental hospital drops off severely ill woman at bus station to make\
it home by herself. Since this is Fark, you can assume she didn&#39;t make it
AMUSING
Professional coffee taster&#39;s tongue insured for $14 million. The man&#39;s to\
ngue works magic on the bean
HERO
In celebration of his 69th birthday tomorrow, Chuck Norris will randomly \
select one lucky child to be thrown into the sun
FLORIDA
Moving pot plants to an undisclosed location to deter would-be burglars i\
s a GREAT idea. Just don&#39;t do it using an open-bed pickup truck. Police m\
ight see you</code></pre>
</figure><p>Occasionally I saw HTML entities in the output. <code>&amp;quot;</code>, stuff like that. Let’s fix that problem before we move on to anything else.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;cgi&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rss_url</span>       <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">limit</span>         <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">title_pattern</span> <span class="o">=</span> <span class="no">Regexp</span><span class="o">.</span><span class="n">new</span> <span class="sr">%r{\[(.+?)\]\s(.+)$}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">document</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rss_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span> <span class="o">=</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">  <span class="n">title_match</span> <span class="o">=</span> <span class="n">title_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">title_match</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">category</span> <span class="o">=</span> <span class="no">CGI</span><span class="o">::</span><span class="n">unescapeHTML</span><span class="p">(</span><span class="n">title_match</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">upcase</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span>    <span class="o">=</span> <span class="no">CGI</span><span class="o">::</span><span class="n">unescapeHTML</span><span class="p">(</span><span class="n">title_match</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">puts</span> <span class="n">category</span><span class="p">,</span> <span class="n">title</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>It isn’t an issue this time, but I feel better.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb
INTERESTING
Research shows that older fathers tends to has more kids who is dumb
FLORIDA
If you want to avoid suspicion of driving under the influence, the first \
step would be to make sure you&#39;re driving on a full set of tires
INTERESTING
Vatican claims washing machine is most liberating 20th century invention \
for women. Sybian didn&#39;t even make the list
STRANGE
Today&#39;s moral outrage comes from Geneva, Switzerland, where a known prost\
itute activist was buried in the same cemetery as John Calvin
INTERESTING
Meghan McCain calls Ann Coulter &#34;offensive&#34; and &#34;insulting,&#34; adding &#34;are \
you going to finish those fries?&#34;
INTERESTING
Worried about being the washed-up former high school football star while \
those nerds you picked on become millionaires later in life? Well, good n\
ews
SAD
State mental hospital drops off severely ill woman at bus station to make\
it home by herself. Since this is Fark, you can assume she didn&#39;t make it
AMUSING
Professional coffee taster&#39;s tongue insured for $14 million. The man&#39;s to\
ngue works magic on the bean
HERO
In celebration of his 69th birthday tomorrow, Chuck Norris will randomly \
select one lucky child to be thrown into the sun
FLORIDA
Moving pot plants to an undisclosed location to deter would-be burglars i\
s a GREAT idea. Just don&#39;t do it using an open-bed pickup truck. Police m\
ight see you</code></pre>
</figure><p>Wherever possible, I’m using standard library tools to get my work done. I’m too lazy to remember escaping every possible HTML entity, and I would rather spend a few minutes searching through the <a href="http://www.ruby-doc.org/stdlib/">Standard Library documentation</a> to find what I need. It’s a good habit, and you might want to try it yourself.</p>
<p>Maybe I only care about particular types of headline. Say, I want to be interested, but not amused.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;cgi&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rss_url</span>            <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">limit</span>              <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">title_pattern</span>      <span class="o">=</span> <span class="no">Regexp</span><span class="o">.</span><span class="n">new</span> <span class="sr">%r{\[(.+?)\]\s(.+)$}</span>
</span></span><span class="line"><span class="cl"><span class="n">preferred_category</span> <span class="o">=</span> <span class="s1">&#39;INTERESTING&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">document</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rss_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span> <span class="o">=</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">  <span class="n">title_match</span> <span class="o">=</span> <span class="n">title_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">title_match</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">category</span> <span class="o">=</span> <span class="no">CGI</span><span class="o">::</span><span class="n">unescapeHTML</span><span class="p">(</span><span class="n">title_match</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">upcase</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="n">preferred_category</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="n">title</span> <span class="o">=</span> <span class="no">CGI</span><span class="o">::</span><span class="n">unescapeHTML</span><span class="p">(</span><span class="n">title_match</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="n">title</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>And it does indeed show me only &ldquo;interesting&rdquo; headlines.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb
New study concludes that viewing television before age 2 has no negative \
effect on development. Great - NOW who are we supposed to blame for rampa\
nt toddler sex and violence??
Research shows that older fathers tends to has more kids who is dumb
Vatican claims washing machine is most liberating 20th century invention \
for women. Sybian didn&#39;t even make the list
Meghan McCain calls Ann Coulter &#34;offensive&#34; and &#34;insulting,&#34; adding &#34;are \
you going to finish those fries?&#34;
Worried about being the washed-up former high school football star while \
those nerds you picked on become millionaires later in life? Well, good n\
ews</code></pre>
</figure><p>That’s pretty nifty, except that it only looks for Interesting items out of the last 10 headlines, rather than looking for the last 10 Interesting headlines.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;cgi&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rss_url</span>            <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">limit</span>              <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">title_pattern</span>      <span class="o">=</span> <span class="no">Regexp</span><span class="o">.</span><span class="n">new</span> <span class="sr">%r{\[(.+?)\]\s(.+)$}</span>
</span></span><span class="line"><span class="cl"><span class="n">preferred_category</span> <span class="o">=</span> <span class="s1">&#39;Interesting&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">document</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rss_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span> <span class="o">=</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="n">title_match</span> <span class="o">=</span> <span class="n">title_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">title_match</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">category</span> <span class="o">=</span> <span class="no">CGI</span><span class="o">::</span><span class="n">unescapeHTML</span><span class="p">(</span><span class="n">title_match</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">category</span><span class="o">.</span><span class="n">upcase</span> <span class="o">==</span> <span class="n">preferred_category</span><span class="o">.</span><span class="n">upcase</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="n">title</span> <span class="o">=</span> <span class="no">CGI</span><span class="o">::</span><span class="n">unescapeHTML</span><span class="p">(</span><span class="n">title_match</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="n">title</span>
</span></span><span class="line"><span class="cl">      <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Is this any better?</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb
New study concludes that viewing television before age 2 has no negative \
effect on development. Great - NOW who are we supposed to blame for rampa\
nt toddler sex and violence??
Research shows that older fathers tends to has more kids who is dumb
Vatican claims washing machine is most liberating 20th century invention \
for women. Sybian didn&#39;t even make the list
Meghan McCain calls Ann Coulter &#34;offensive&#34; and &#34;insulting,&#34; adding &#34;are \
you going to finish those fries?&#34;
Worried about being the washed-up former high school football star while \
those nerds you picked on become millionaires later in life? Well, good n\
ews</code></pre>
</figure><p>Well, we can only look at today’s headlines. I guess we can’t be sure of ten interesting things happening every day. Still, at least I know I’m getting all of the interesting headlines that are available, up to my limit.</p>
<p>Next problem: the only way I can fetch different headline types is to manually dig in to the source code and change the category.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;open-uri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;cgi&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;optparse&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rss_url</span>            <span class="o">=</span> <span class="s1">&#39;http://www.fark.com/fark.rss&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">limit</span>              <span class="o">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">title_pattern</span>      <span class="o">=</span> <span class="no">Regexp</span><span class="o">.</span><span class="n">new</span> <span class="sr">%r{(.+)\s\[(.+)\]$}</span>
</span></span><span class="line"><span class="cl"><span class="n">preferred_category</span> <span class="o">=</span> <span class="kp">nil</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get the preferred category, if any, from the command line.</span>
</span></span><span class="line"><span class="cl"><span class="n">opts</span> <span class="o">=</span> <span class="no">OptionParser</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">opts</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="n">opts</span><span class="o">.</span><span class="n">banner</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">#{</span><span class="vg">$0</span><span class="si">}</span><span class="s2"> [options]&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">opts</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">opts</span><span class="o">.</span><span class="n">separator</span><span class="p">(</span><span class="s2">&#34;Specific Options&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">opts</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&#34;-c&#34;</span><span class="p">,</span> <span class="s2">&#34;--category CATEGORY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;Only grab headlines in specific category&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">cat</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="n">preferred_category</span> <span class="o">=</span> <span class="n">cat</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">opts</span><span class="o">.</span><span class="n">on_tail</span><span class="p">(</span><span class="s2">&#34;-h&#34;</span><span class="p">,</span> <span class="s2">&#34;--help&#34;</span><span class="p">,</span> <span class="s2">&#34;Show this usage display&#34;</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">puts</span> <span class="n">opts</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">opts</span><span class="o">.</span><span class="n">parse!</span><span class="p">(</span><span class="no">ARGV</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">document</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rss_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span> <span class="o">=</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">rss</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="p">,</span> <span class="n">index</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">  <span class="n">title_match</span> <span class="o">=</span> <span class="n">title_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="n">title_match</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">category</span> <span class="o">=</span> <span class="no">CGI</span><span class="o">::</span><span class="n">unescapeHTML</span><span class="p">(</span><span class="n">title_match</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">preferred_category</span><span class="o">.</span><span class="n">nil?</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="n">title</span><span class="p">,</span> <span class="n">category</span>
</span></span><span class="line"><span class="cl">    <span class="k">elsif</span> <span class="n">category</span><span class="o">.</span><span class="n">upcase</span> <span class="o">==</span> <span class="n">preferred_category</span><span class="o">.</span><span class="n">upcase</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="n">title</span>
</span></span><span class="line"><span class="cl">      <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="n">limit</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Let’s test it by requesting &ldquo;PSA&rdquo; headlines.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby19 fark.rb -c psa

Attention zoo visitors - please do not taunt the concrete chimpanzee</code></pre>
</figure><p>That works. Pretty nicely, I might add. <a href="http://www.ruby-doc.org/stdlib/libdoc/optparse/rdoc/">OptParse</a> is a great library for handling command-line arguments.</p>
<p>This program now does everything that I set out to do, and then some. I might choose to do a some refactoring to &ldquo;bulletproof&rdquo; the code, or wrap it up in some OO niceness to make it pretty. The truth is that this application is exactly what it needs to be for now, and I think that I shouldn’t overwork something that I may never come back to. Maybe later I’ll come back to it when I think of new features or find new bugs, and <em>then</em> I can overwork it to my heart’s content.</p>
<p>I hope you enjoyed working along with me as much as I enjoyed sitting here and typing random nonsense to myself.</p>
<h2 id="what-else">What Else?</h2>
<p>I may be done with this exercise for now, but here are a few ideas about features that can be added to make it a little cooler. Go ahead and try them out!</p>
<ul>
<li>Add word wrap to make the output a little more readable.</li>
<li>Add a parameter to change the number of headlines grabbed.</li>
<li>Modify so that this script will work with other newsfeeds.</li>
<li>Modify so that the functionality of this script can be embedded in other Ruby programs.</li>
</ul>
]]></content:encoded>
</item>
<item>
  <title>Post: The MIRES</title>
  <link>https://randomgeekery.org/post/2004/09/the-mires/</link>
  <pubDate>Fri, 17 Sep 2004 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/09/the-mires/</guid>
  <description>Okay, here’s the plan. Every couple of weeks I will try to think of one interesting thing to do with Ruby. I will then proceed to actually do this interesting thing, recording my progress as I move along. Then I will compile my notes from the recorded progress and turn them into a brief tutorial on how you, the Esteemed Reader, can accomplish the same task. Now, what is interesting to me may be mind-numbingly boring or childishly simple for you.</description>
   <category>post</category> 
   <category>post</category> 
   <category>ruby</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<h2>A short series of posts I wrote on doing moderately interesting ruby exercises.
</h2><p>Okay, here’s the plan. Every couple of weeks I will try to think of one interesting thing to do with Ruby. I will then proceed to actually <em>do</em> this interesting thing, recording my progress as I move along. Then I will compile my notes from the recorded progress and turn them into a brief tutorial on how you, the Esteemed Reader, can accomplish the same task. Now, what is interesting to me may be mind-numbingly boring or childishly simple for you. It isn’t likely that <em>everybody</em> will feel the love for this section of the site. That’s okay, though, because I am largely doing this as part of my own efforts to deepen my understanding of the Ruby language.</p>
<ul>
<li><a href="/post/2004/09/look-at-the-latest-fark-headlines/">look-at-the-latest-fark-headlines</a></li>
<li><a href="/post/2004/10/drawing-celtic-knotwork/">drawing-celtic-knotwork</a></li>
</ul>
]]></content:encoded>
</item>
<item>
  <title>Post: UNIX</title>
  <link>https://randomgeekery.org/post/2004/09/unix/</link>
  <pubDate>Wed, 15 Sep 2004 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/09/unix/</guid>
  <description>People who come to UNIX (or Linux) from the world of Windows are often disappointed by the apparent clunkiness and lack of unified tools. “Where’s Visual Studio? Where’s C&#43;&#43; Builder? Heck, Notepad would be nice.” These folks are looking all around for an IDE, or Integrated Development Environment. What they don’t realize is that UNIX is an Integrated Development Environment. You can’t get around the fact that this environment was made for geeks, by geeks.</description>
   <category>post</category> 
   <category>post</category> 
   <category>unix</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<p>People who come to UNIX (or <em>Linux</em>) from the world of Windows are often disappointed by the apparent clunkiness and lack of unified tools. &ldquo;Where’s Visual Studio? Where’s C++ Builder? Heck, Notepad would be nice.&rdquo; These folks are looking all around for an IDE, or Integrated Development Environment. What they don’t realize is that UNIX <em>is</em> an Integrated Development Environment. You can’t get around the fact that this environment was made for geeks, by geeks. That means a lot of the programs that seem so clunky and awkward to the Windows person are, in fact, intended to work together to make development easier. Okay, so they aren’t all pointy-clicky and pretty, but that’s because pointy-clicky and pretty aren’t as important to these particular folks.</p>
<p>That’s not to say the graphical IDE’s aren’t out there if you want them. Try <a href="http://www.kdevelop.org/">KDevelop</a> or <a href="http://anjuta.org/">Anjuta</a>. They are excellent environments, providing a layer of comfortable friendliness on top of the powerful UNIX toolkit. But this section of COOLNAMEHERE isn’t about these GUI environments. It’s about UNIX itself, and the huge assortment of tools available to streamline life for the determined geek. I’ll start by examining the tools one at a time, as I use them and discover nifty new things about them myself. It’s possible that I will add articles about using the tools in tandem with each other, to really explore the power available. But first I need to discover some of that power myself :smile:</p>
]]></content:encoded>
</item>
</channel>
</rss>

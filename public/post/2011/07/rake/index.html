<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.60856f0f2ed73fb3cd2820ee548c4698ffbc4d743736e852c0e27ce4f52dfd9c.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  

<meta property="og:url" content="https://randomgeekery.org/post/2011/07/rake/">
<meta property="og:title" content="Rake">
<meta name="twitter:title" content="Rake">


  <meta name="twitter:site" content="@brianwisti">



  
    <meta name="twitter:description" content="Rake is a simple build program. You can use it to automate complex or repetitive tasks. It is written in Ruby, but is useful in far more than just Ruby projects.
The great news is that if you have Ruby on your system, you probably already have Rake. It has been included as part of the standard Ruby distribution for a few years.
It is easy to test which version of Rake you have from the command line:">
    <meta property="og:description" content="Rake is a simple build program. You can use it to automate complex or repetitive tasks. It is written in Ruby, but is useful in far more than just Ruby projects.
The great news is that if you have Ruby on your system, you probably already have Rake. It has been included as part of the standard Ruby distribution for a few years.
It is easy to test which version of Rake you have from the command line:">
  



<title itemprop="name">Rake - Random Geekery</title>
<meta property="og:title" content=Rake&#32;-&#32;Random&#32;Geekery />
<meta name="twitter:title" content=Rake&#32;-&#32;Random&#32;Geekery />
<meta itemprop="name" content=Rake&#32;-&#32;Random&#32;Geekery />
<meta name="application-name" content=Rake&#32;-&#32;Random&#32;Geekery />
<meta property="og:site_name" content="Random Geekery" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://randomgeekery.org/post/2011/07/rake/" />
<link rel="canonical" href="https://randomgeekery.org/post/2011/07/rake/" itemprop="url" />
<meta name="url" content="https://randomgeekery.org/post/2011/07/rake/" />
<meta name="twitter:url" content="https://randomgeekery.org/post/2011/07/rake/" />
<meta property="og:url" content="https://randomgeekery.org/post/2011/07/rake/" />


<meta property="og:updated_time" content=18007-18-12T70:00:11-0700 />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://randomgeekery.org/sitemap.xml' />

  <link
      rel="alternate"
      type="application/rss+xml"
    
        href="/index.xml"
    
      title="Random Geekery"/>



<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="" />
<meta name="twitter:creator" content="" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="Random Geekery" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.121.2">


    
    

<link
    rel="stylesheet"
    href="/css/style.fe9735814e6394fb590ff4fd2eb036a13152e6808ad90dd06ba181d89087b5d3.css"
    integrity="sha256-/pc1gU5jlPtZD/T9LrA2oTFS5oCK2Q3Qa6GB2JCHtdM=" 
    crossorigin="anonymous">


</head>

    <body class="">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
        
            <a href="https://randomgeekery.org">
                <h1>Random Geekery</h1>
            </a>
        
    </h1>
    <p class="lead">
    Collecting my attempts to improve at tech, art, and life
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">
      
        <li class="bullet">
          <a href="/follow/">Follow</a>
        </li>
      
        <li class="bullet">
          <a href="/now/">Now</a>
        </li>
      
    </ul>
</nav>

        
  <div class="related">
    <div class="related-posts">
      <h3>Related</h3>
      <ul>
        
          <li><a href="/post/2021/02/tweaking-my-tools/">Tweaking my tools</a></li>
        
          <li><a href="/post/2020/05/letting-ruby-build-asciidoctor-files-for-hugo/">Letting Ruby build Asciidoctor files for Hugo</a></li>
        
          <li><a href="/post/2018/05/crafts-are-now-posts/">Crafts Are Now Posts</a></li>
        
          <li><a href="/post/2014/07/welcome-to-jekyll/">Welcome to Jekyll!</a></li>
        
          <li><a href="/post/2013/11/my-own-ruby-fibers-babystep/">My Own Ruby Fibers Babystep</a></li>
        
      </ul>
    </div>
  </div>



        
















        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 Brian Wisti. All rights reserved.
</p>
<p class="footnote">
  This work is licensed under a
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License
  </a>.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <nav class="masthead">
    <ul>
    
  
    
  
    
  
    
  

    <li><a href="https://randomgeekery.org/">Random Geekery</a></li>
  

    <li><a href="https://randomgeekery.org/post/">Posts</a></li>
  

    <li><a href="https://randomgeekery.org/post/2011/">2011</a></li>
  

    <li><a class="active" href="https://randomgeekery.org/post/2011/07/rake/">Rake</a></li>
</nav>



  <div class="info">
    <h1 class="post-title">
        <a href="https://randomgeekery.org/post/2011/07/rake/">Rake</a>
    </h1>
    
        <time datetime="2011-07-18T00:00:00-0700" class="post-date">
            July 18, 2011
        </time>
    
    
    <ul class="tags">
        
        <li class="tag-ruby">
            <a href="https://randomgeekery.org/tags/ruby">ruby</a>
        </li>
        
        <li class="tag-site">
            <a href="https://randomgeekery.org/tags/site">site</a>
        </li>
        
        <li class="tag-coolnamehere">
            <a href="https://randomgeekery.org/tags/coolnamehere">coolnamehere</a>
        </li>
        
    </ul>
    
    
    
    
    
    
</div>

  <p><a href="https://ruby.github.io/rake/">Rake</a> is a simple build program.
You can use it to automate complex or repetitive tasks.
It is written in <a href="/card/ruby/">Ruby</a>, but is useful in far more than just Ruby projects.</p>
<p>The great news is that if you have Ruby on your system, you <em>probably</em> already have Rake.
It has been included as part of the standard Ruby distribution for a few years.</p>
<p>It is easy to test which version of Rake you have from the command line:</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake --version
</span></span><span class="line"><span class="cl"><span class="go">rake, version 0.9.2
</span></span></span></code></pre>
</figure><p>If you do not have Rake, then you just need to install a fresh release of Ruby.
Go ahead.
I’ll wait.</p>
<p>Rake is driven by a <em>Rakefile</em>.
A Rakefile is a collection of Ruby instructions organized into <em>tasks</em>.</p>
<p>This is not going to be an in-depth Rake tutorial.  I’ve noticed a lack of simple real-world Rakefile examples, aside from one excellent <a href="https://www.stuartellis.eu/articles/rake">Rake introduction</a>. I have a Rakefile I need to build.  That makes this a good opportunity for me to write a page about Rake.</p>
<h2 id="building-a-simple-rakefile">Building a Simple Rakefile</h2>
<p>I have a Web site. You may have noticed that.
If you only know me from my frequent postings on social network sites like <a href="https://plurk.com">Plurk</a> or Google+.
I assure you that I do indeed have a Web site.</p>
<p>The thing about my Web site is that rather than use Drupal or some other convenient Content Management System,
I use a tool that generates static HTML.
The static HTML and associated files like images and stylesheets are then uploaded to an inexpensive Web host.
Hey.
It works for me.
Static HTML serves fast, and I don’t change the content on my site <em>that</em> often.</p>
<p>I invoke a simple command to build my site before uploading it.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ python site-builder.py</code></pre>
</figure><p>That is not painful, but it does get boring.
More importantly, I have been thinking about how <a href="http://beta.compass-style.org">Compass</a> would be a great thing to use for my site.
But <code>site-builder.py</code> is an ugly, ugly piece of hackery.
It is just coherent enough to build the site you’re reading.
It is <em>certainly</em> not up to the job of driving Compass.
That’s where Rake comes in.</p>
<h3 id="one-task">One Task</h3>
<p>You might want to use the exact same Rake tasks as me while you read this.
Here is a dummy version of <code>site-builder.py</code> that you can use.
No, it does not build a site.
It <em>will</em> give you something to work with for demonstrating Rake, though.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Imaginary version of site-builder.py</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="n">__main__</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;Look at me, I&#39;m building a site!&#34;</span></span></span></code></pre>
</figure><p>First I will start by creating a Rakefile to handle my current workflow.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># Rakefile for coolnamehere.com</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:html</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">sh</span> <span class="s2">&#34;python site-builder.py&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>The simplest Rake <code>task</code> command takes two arguments:
a name for that task, and a block of actions to perform when that task is requested.
The name can be written as a String or as a Symbol, but I usually see it written as a Symbol.</p>
<p>The block can be any valid Ruby code.
The <code>:html</code> block uses my shell to run the Python script that builds coolnamehere.com.
You ask Rake to execute a particular task from the command line by using the task’s name.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake html
</span></span><span class="line"><span class="cl"><span class="go">python site-builder.py
</span></span></span><span class="line"><span class="cl"><span class="go">Look at me, I&#39;m building a site!
</span></span></span></code></pre>
</figure><p>How do you find out what tasks are available, aside from reading the Rakefile?
The -T flag will ask Rake to list all of the available tasks.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">rake -T</span></span></code></pre>
</figure><p>Oh.
Hold on a second.
Rake will only list the tasks you have described with the <code>desc</code> command.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Generate Web site&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:html</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">sh</span> <span class="s2">&#34;python site-builder.py&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Let us try that again.
The <code>-T</code> flag will ask Rake to list all of the available <em>described</em> tasks.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake -T
</span></span><span class="line"><span class="cl"><span class="go">rake html  # Generate Web site
</span></span></span></code></pre>
</figure><p>A Rakefile can have many tasks, but some of them may be utility tasks which are not expected to be called by the user.
That is why limiting the task list to described tasks is a good idea.</p>
<h3 id="a-second-task">A Second Task</h3>
<p>As I mentioned before, part of the reason I am writing a Rakefile is because I want to use Compass to define the styles for coolnamehere.
I set up a Compass project parallel to my site sources, including the blueprint module.
The Compass project is called &ldquo;style&rdquo;.
My projects generally do not have clever names.</p>
<p>If you <em>really</em> want to play along, here is how I set up my Compass project.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">gem install compass
</span></span><span class="line"><span class="cl">compass create style --using blueprint</span></span></code></pre>
</figure><p>This is another straightforward task.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Generate style sheets&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:css</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">sh</span> <span class="s2">&#34;compass compile style&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>I do not expect anything exciting to happen, since I have not changed the SCSS files.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake css
</span></span><span class="line"><span class="cl"><span class="go">compass compile style
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/ie.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/print.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/screen.scss
</span></span></span></code></pre>
</figure><p>There is still a problem, though.
All of the stylesheets are in <code>style/stylesheets</code>,
but the working stylesheets have been over in <code>site/inc/css</code>.
I need Rake to copy the finished stylesheets to the expected location.
Might as well copy the images that are sitting in the <code>style</code> project while I am at it.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Generate style sheets&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:css</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">sh</span> <span class="s2">&#34;compass compile style&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cp</span> <span class="no">Dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&#34;style/stylesheets/*&#34;</span><span class="p">),</span> <span class="s2">&#34;source/inc/css&#34;</span><span class="p">,</span> <span class="ss">:verbose</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl">  <span class="n">cp</span> <span class="no">Dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&#34;style/stylesheets/images/*&#34;</span><span class="p">),</span> <span class="s2">&#34;source/inc/images&#34;</span><span class="p">,</span> <span class="ss">:verbose</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Rake conveniently imports the FileUtils module.
This lets me use Ruby standard library methods such as <code>cp</code> to copy a list of files rather than relying on platform-specific shell commands.</p>
<p>What does that look like in action?</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake css
</span></span><span class="line"><span class="cl"><span class="go">compass compile style
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/ie.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/print.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/screen.scss
</span></span></span><span class="line"><span class="cl"><span class="go">cp -r style/stylesheets/ie.css style/stylesheets/print.css style/stylesheets/screen.css source/inc/css
</span></span></span><span class="line"><span class="cl"><span class="go">cp -r style/images/grid.png source/inc/images
</span></span></span></code></pre>
</figure><p>Good enough.
Excuse me while I adjust my HTML template to point at the right stylesheets.</p>
<h3 id="setting-a-dependency">Setting a Dependency</h3>
<p>There are already awkward bits to the Rakefile as it is right now.
I need to run two commands in order to build the site completely.
Because <code>site-builder.py</code> also copies the site files to a new location, I must also remember to run the commands in the correct order.
If I don’t, then the generated CSS will go into my site sources after the HTML has already been generated and copied.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake css
</span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">$</span> rake html
</span></span><span class="line"><span class="cl"><span class="go">...
</span></span></span></code></pre>
</figure><p>What if I made <code>:css</code> a <em>dependency</em> of <code>:html</code>?
Rake would make sure that the <code>:css</code> task was executed before it tried to execute the <code>:html</code> task.</p>
<p>A little syntax trickery simplifies the task of describing a task’s dependencies.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Generate Web site&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:html</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:css</span><span class="o">]</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">sh</span> <span class="s2">&#34;python site-builder.py&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Now instead of just a name for the task, we are giving <code>task</code> a Hash.
The only key of that Hash is the name of the task, and the value is a list of tasks which this one depends on.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake html
</span></span><span class="line"><span class="cl"><span class="go">compass compile style
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/ie.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/print.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/screen.scss
</span></span></span><span class="line"><span class="cl"><span class="go">cp -r style/stylesheets/ie.css style/stylesheets/print.css style/stylesheets/screen.css source/inc/css
</span></span></span><span class="line"><span class="cl"><span class="go">cp -r style/images/grid.png source/inc/images
</span></span></span><span class="line"><span class="cl"><span class="go">python site-builder.py
</span></span></span><span class="line"><span class="cl"><span class="go">Look at me, I&#39;m building a site!
</span></span></span></code></pre>
</figure><p>Excellent.
Now I can generate both CSS and HTML from a single Rake command.
I am going to work a little bit on the styles, and to see if I notice any other little issues with my Rakefile.</p>
<h3 id="setting-the-default-task">Setting The Default Task</h3>
<p>It has been pretty effective so far.
Incidentally, Compass is kind of awesome.
I highly recommend you check it out for your Web design needs.</p>
<p>It would be nice if I could make the <code>rake</code> call a little shorter, though.
I have a shortcut set up in <a href="/card/vim/">Vim</a> that invokes Rake with a default argument.
It would be nice to use that shortcut while I am working on coolnamehere.</p>
<p>Rake already has rules for default tasks, actually.
It looks for a task named &ldquo;default&rdquo; or <code>:default</code>.
That makes sense.
Let me set up a default task that depends on the <code>:html</code> task.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:default</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:html</span><span class="o">]</span></span></span></code></pre>
</figure><p>That is all I need to do, actually.
A task can simply be a name and its dependencies.
You do not <em>need</em> to define a block of actions for that task.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> rake
</span></span><span class="line"><span class="cl"><span class="go">compass compile style
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/ie.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/print.scss
</span></span></span><span class="line"><span class="cl"><span class="go">unchanged style/sass/screen.scss
</span></span></span><span class="line"><span class="cl"><span class="go">cp -r style/stylesheets/ie.css style/stylesheets/print.css style/stylesheets/screen.css source/inc/css
</span></span></span><span class="line"><span class="cl"><span class="go">cp -r style/images/grid.png source/inc/images
</span></span></span><span class="line"><span class="cl"><span class="go">python site-builder.py
</span></span></span><span class="line"><span class="cl"><span class="go">Look at me, I&#39;m building a site!
</span></span></span></code></pre>
</figure><h3 id="something-i-have-been-meaning-to-get-around-to">Something I Have Been Meaning To Get Around To</h3>
<p>I have been promising myself for years that I will assemble some sort of script that would automate the process of uploading my site.
I never get around to it, though.
Instead I fire up NCFTP, load the &ldquo;coolnamehere&rdquo; bookmark I’ve had for years, and upload.</p>
<p>It is time to fix that by adding an &ldquo;upload&rdquo; task.
I will take advantage of the <a href="https://github.com/glejeune/syncftp">syncftp</a> Ruby library,
which looks like it will handle all of the little details.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">gem install syncftp</span></span></code></pre>
</figure><p>For the first test, I will just fill in the blanks using the syncftp README as a guide.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Transfer site to the remote host&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:upload</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:html</span><span class="o">]</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">ftp</span> <span class="o">=</span> <span class="no">SyncFTP</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;ftp.myhost.com&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="ss">:password</span> <span class="o">=&gt;</span> <span class="s1">&#39;supersecret&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ftp</span><span class="o">.</span><span class="n">sync</span> <span class="ss">:local</span> <span class="o">=&gt;</span> <span class="s1">&#39;build&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="ss">:remote</span> <span class="o">=&gt;</span> <span class="s1">&#39;public_html&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><h2 id="conclusion">Conclusion</h2>
<p>Here’s the complete Rakefile, with the as-yet untested &ldquo;upload&rdquo; task.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:default</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:html</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Generate Web site&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:html</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:css</span><span class="o">]</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">sh</span> <span class="s2">&#34;python site-builder.py&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Generate style sheets&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:css</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">sh</span> <span class="s2">&#34;compass compile style&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cp</span> <span class="no">Dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&#34;style/stylesheets/*&#34;</span><span class="p">),</span> <span class="s2">&#34;source/inc/css&#34;</span><span class="p">,</span> <span class="ss">:verbose</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl">  <span class="n">cp</span> <span class="no">Dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&#34;style/stylesheets/images/*&#34;</span><span class="p">),</span> <span class="s2">&#34;source/inc/images&#34;</span><span class="p">,</span> <span class="ss">:verbose</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">desc</span> <span class="s2">&#34;Transfer site to the remote host&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">task</span> <span class="ss">:upload</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:html</span><span class="o">]</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">ftp</span> <span class="o">=</span> <span class="no">SyncFTP</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;ftp.myhost.com&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="ss">:username</span> <span class="o">=&gt;</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="ss">:password</span> <span class="o">=&gt;</span> <span class="s1">&#39;supersecret&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ftp</span><span class="o">.</span><span class="n">sync</span> <span class="ss">:local</span> <span class="o">=&gt;</span> <span class="s1">&#39;build&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="ss">:remote</span> <span class="o">=&gt;</span> <span class="s1">&#39;public_html&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Well, yes.
There are differences from the <em>actual</em> Rakefile, but this gets the idea across.</p>
<p>All that I need to do now is test it.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">rake upload</span></span></code></pre>
</figure>
  






  <hr>
  

  
  
<hr>
<div class="footer">
    
    
      <a class="previous-post" href="https://randomgeekery.org/post/2011/06/python-2-babysteps-01-installing-python-2/?ref=footer">
        <span style="font-weight:bold;">« Previous</span>
        <br>Python 2 Babysteps 01 Installing Python 2
      </a>
    
    
      <div class="next-post">
        <a href="https://randomgeekery.org/post/2011/08/moose/?ref=footer">
          <span style="font-weight:bold;">Next »</span>
          <br>Moose
        </a>
      </div>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#building-a-simple-rakefile">Building a Simple Rakefile</a>
      <ul>
        <li><a href="#one-task">One Task</a></li>
        <li><a href="#a-second-task">A Second Task</a></li>
        <li><a href="#setting-a-dependency">Setting a Dependency</a></li>
        <li><a href="#setting-the-default-task">Setting The Default Task</a></li>
        <li><a href="#something-i-have-been-meaning-to-get-around-to">Something I Have Been Meaning To Get Around To</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div><script defer data-domain="randomgeekery.org" src="https://plausible.io/js/script.js"></script>
    </body>
</html>

<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>celticonRandom Geekery</title>
    <link>https://randomgeekery.org/tags/celtic/</link>
    <description>
      Recent contentinceltic on Random Geekery
    </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
      
      <lastBuildDate>Thu, 17 May 2018 00:00:00 -0700</lastBuildDate><atom:link href="https://randomgeekery.org/tags/celtic/index.xml" rel="self" type="application/rss+xml" /><item>
  <title>Post: Purple Symmetry</title>
  <link>https://randomgeekery.org/post/2018/05/purple-symmetry/</link>
  <pubDate>Thu, 17 May 2018 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2018/05/purple-symmetry/</guid>
  <description>Spent over a week on this, which is quite the marathon for me.</description>
   <category>post</category> 
   <category>post</category> 
   <category>drawing</category>  <category>sketchbook-mobile</category>  <category>celtic</category>  <category>zentangle</category>  <category>craft</category> 
  <content:encoded><![CDATA[<p>Spent over a week on this, which is quite the marathon for me.</p>
<p><figure>
    <img src="/../../../attachments/img/2018/cover-2018-05-17.jpg" alt="attachments/img/2018/cover-2018-05-17.jpg"/></figure></p>
]]></content:encoded>
</item>
<item>
  <title>Post: Duotone Panel</title>
  <link>https://randomgeekery.org/post/2017/12/duotone-panel/</link>
  <pubDate>Tue, 19 Dec 2017 00:00:00 -0800</pubDate>
  
  <guid>https://randomgeekery.org/post/2017/12/duotone-panel/</guid>
  <description>&lt;p&gt;&lt;figure&gt;
    &lt;img src=&#34;https://randomgeekery.org/../../../attachments/img/2017/cover-2017-12-19.jpg&#34; alt=&#34;attachments/img/2017/cover-2017-12-19.jpg&#34;/&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Last month I read an article about &lt;a href=&#34;https://muddycolors.blogspot.com/2012/08/duotone-illustrations.html&#34;&gt;duotone illustrations&lt;/a&gt; and decided to try
a version of the technique myself someday. Today was that day.&lt;/p&gt;</description>
   <category>post</category> 
   <category>post</category> 
   <category>drawing</category>  <category>procreate</category>  <category>celtic</category>  <category>zentangle</category>  <category>craft</category> 
  <content:encoded><![CDATA[<p><figure>
    <img src="/../../../attachments/img/2017/cover-2017-12-19.jpg" alt="attachments/img/2017/cover-2017-12-19.jpg"/></figure></p>
<p>Last month I read an article about <a href="https://muddycolors.blogspot.com/2012/08/duotone-illustrations.html">duotone illustrations</a> and decided to try
a version of the technique myself someday. Today was that day.</p>
<p><a href="https://en.wikipedia.org/wiki/Duotone">Duotone</a> uses two colors — usually black and a color such as blue or red — to make an image. It was popular for a while in 20th Century illustration because it cost less than full color printing. Skilled duotone illustrators like <a href="https://americanillustration.org/project/mead-schaeffer/">Mead Schaeffer</a> produced visually arresting images.</p>
<p><figure>
    <img src="/attachments/img/2017/mead-schaeffer-red.jpg" alt="&ldquo;Red&rdquo; by Mead Schaeffer"/></figure></p>
<p><em>Illustration by Mead Schaeffer via <a href="https://muddycolors.blogspot.com/2012/08/duotone-illustrations.html">Muddy Colors</a></em></p>
<p>I wanted to manually create duotone images in sketch apps like Procreate. Time to describe what I came up with.</p>
<p>This post isn’t a tutorial, but the information may be useful to you. For that matter it may be useful to <em>me</em>. That’s really what this whole site is about, after all: making life easier for future me, and hopefully maybe you too.</p>
<p>I had a couple of self-imposed limitations while making this. I deliberately chose to only use flat color for this experiment — no shading to speak of. I also used a smaller canvas than usual. It wasn’t a technical limitation, but it did limit the detail I could put into the image.</p>
<p>In retrospect, that’s probably a good thing for this experiment. I ended up with about 50 layers the way I put things together, and this might have slowed my iPad down with a large image.</p>
<h2 id="linework">Linework</h2>
<p>The first finished step is a solid black and white image. It started out as a
knotwork panel demonstration, but somewhere along the way I decided the panel
needed extras. Most of those extras came from <a href="https://www.goodreads.com/book/show/26311641-the-tangles-of-kells">Tangles of Kells</a>.</p>
<p><figure>
    <img src="/attachments/img/2017/duotone-panel-linework.png" alt="Linework"/></figure></p>
<h2 id="values">Values</h2>
<p>Then I put the values in, working from a grayscale palette. Nothing fancy going on here. The background is darker, the foreground is lighter, with a couple small variations along the way.</p>
<p>I set the drop shadow layers to &ldquo;Soft Light&rdquo; so they wouldn’t obscure whatever was beneath them.</p>
<p><figure>
    <img src="/attachments/img/2017/duotone-panel-values.png" alt="Values"/></figure></p>
<h2 id="color">Color</h2>
<p>For color, I created a new layer under the value layers, which I set to &ldquo;Multiply.&rdquo;</p>
<p>Here’s what that looked like, with everything else but linework cut out.</p>
<p><figure>
    <img src="/attachments/img/2017/duotone-panel-color.png" alt="Color"/></figure></p>
<p>I had an initial stage where all the shadows were hatched lines. Duotone didn’t occur to me until near the end of linework. I’ll try value-based shading for everything in some future sketches.</p>
<p>In order to have value mix nicely with color, I put each color layer beneath its value layer and set the value layer’s mode to &ldquo;Multiply.&rdquo;</p>
<h2 id="final">Final</h2>
<p>And that’s how I ended up with this.</p>
<p><figure>
    <img src="/attachments/img/2017/cover-2017-12-19.jpg" alt="Final image"/></figure></p>
<h2 id="what-now">What now?</h2>
<p>That was fun.</p>
<p>I want to explore duotone more, trying some specific ideas.</p>
<ul>
<li>Shading instead of value blocks.</li>
<li>Use higher contrasting values. This ended up just a tiny bit muddy to my eyes.</li>
<li>Multiple color layers — tritone?</li>
<li>Mixing grayscale values and color values in a style more similar to the  duotone illustrations I like so much.</li>
</ul>]]></content:encoded>
</item>
<item>
  <title>Post: Knotwork Practice</title>
  <link>https://randomgeekery.org/post/2017/12/knotwork-practice/</link>
  <pubDate>Fri, 15 Dec 2017 00:00:00 -0800</pubDate>
  
  <guid>https://randomgeekery.org/post/2017/12/knotwork-practice/</guid>
  <description>This started with practicing a knotwork pattern from Celtic Art: The Methods of Construction, and ended up as an exercise in how long I could add stuff before I got bored. Thirteen hours. Not bad.
Not in a row, of course.
Oh and I threw in a couple tangle elements from The Tangles of Kells.
I might be ready to try drawing things on purpose again. Usually it’s just that my hands get itchy when I see blank space.</description>
   <category>post</category> 
   <category>post</category> 
   <category>drawing</category>  <category>procreate</category>  <category>celtic</category>  <category>zentangle</category>  <category>craft</category> 
  <content:encoded><![CDATA[<p><figure>
    <img src="/../../../attachments/img/2017/cover-2017-12-15.jpg" alt="attachments/img/2017/cover-2017-12-15.jpg"/></figure></p>
<p>This started with practicing a knotwork pattern from <a href="https://www.goodreads.com/book/show/618205.Celtic_Art">Celtic Art: The Methods of Construction</a>, and ended up as an exercise in how long I could add stuff before I got bored. Thirteen hours. Not bad.</p>
<p>Not in a row, of course.</p>
<p>Oh and I threw in a couple tangle elements from <a href="https://www.goodreads.com/book/show/26311641-the-tangles-of-kells">The Tangles of Kells</a>.</p>
<p>I might be ready to try drawing things on purpose again. Usually it’s just that my hands get itchy when I see blank space.</p>
]]></content:encoded>
</item>
<item>
  <title>Post: Wrapped Panel</title>
  <link>https://randomgeekery.org/post/2015/08/wrapped-panel/</link>
  <pubDate>Sat, 08 Aug 2015 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2015/08/wrapped-panel/</guid>
  <description>&lt;p&gt;I like this one. Stretching myself with each picture is starting to look interesting.&lt;/p&gt;</description>
   <category>post</category> 
   <category>post</category> 
   <category>drawing</category>  <category>celtic</category>  <category>craft</category> 
  <content:encoded><![CDATA[<h2>I like this one. Stretching myself with each picture is starting to look interesting.
</h2><p>I like this one. Stretching myself with each picture is starting to look interesting.</p>
<p><figure>
    <img src="/../../../attachments/img/2015/cover-2015-08-08.png" alt="attachments/img/2015/cover-2015-08-08.png"/></figure></p>
<p>Started as basic Celtic knotwork practice the other day. Put aside because I thought it needed more, but had no idea. Picked it up this morning and apparently had ideas.</p>
<p>That little circle in the corner is me getting a sudden urge to try some <a href="https://en.wikipedia.org/wiki/George_Bain_%28artist%29">George Bain</a> style construction. It - well - it&rsquo;s not exactly what I saw in my head, but it looks cool.</p>]]></content:encoded>
</item>
<item>
  <title>Post: Celtic Tangle</title>
  <link>https://randomgeekery.org/post/2015/08/celtic-tangle/</link>
  <pubDate>Sat, 01 Aug 2015 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2015/08/celtic-tangle/</guid>
  <description>&lt;p&gt;Another &lt;a href=&#34;https://randomgeekery.org/card/zentangle/&#34;&gt;Zentangle&lt;/a&gt; practice. This time I mixed in a couple of minor Celtic design elements.&lt;/p&gt;</description>
   <category>post</category> 
   <category>post</category> 
   <category>drawing</category>  <category>zentangle</category>  <category>celtic</category>  <category>craft</category> 
  <content:encoded><![CDATA[<p>Another <a href="/card/zentangle/">Zentangle</a> practice. This time I mixed in a couple of minor Celtic design elements.</p>
<p><figure>
    <img src="/../../../attachments/img/2015/cover-2015-08-01.png" alt="attachments/img/2015/cover-2015-08-01.png"/></figure></p>
<p>I tried cleaning it up with <a href="http://www.gimp.org/">GIMP</a>. The end result displeased me so much that I switched to a grayscale of the original scan.</p>]]></content:encoded>
</item>
<item>
  <title>Post: Drawing Celtic Knotwork</title>
  <link>https://randomgeekery.org/post/2004/10/drawing-celtic-knotwork/</link>
  <pubDate>Fri, 01 Oct 2004 00:00:00 -0700</pubDate>
  
  <guid>https://randomgeekery.org/post/2004/10/drawing-celtic-knotwork/</guid>
  <description>2020-08-01
Ye gods. 15,000 words?
I cut this down into smaller blocks after that Raku tangling post. I don’t even care that this post is 16 years old. Somebody might accidentally try to read it!
I touched up what I could without destroying the flow, but things would look much different if I wrote this post today.
Thanks to everybody for the positive feedback on the first MIRE. I still have your attention, so I’ll move on to my next exercise.</description>
   <category>post</category> 
   <category>post</category> 
   <category>ruby</category>  <category>learn</category>  <category>celtic</category>  <category>coolnamehere</category> 
  <content:encoded><![CDATA[<blockquote>
<p><strong>2020-08-01</strong></p>
<p>Ye gods. 15,000 words?</p>
<p>I cut this down into smaller blocks after that <a href="/post/2020/07/tangling-code-from-hugo-content-with-raku/">Raku tangling post</a>. I don’t even care that this post is 16 years old. Somebody might accidentally try to read it!</p>
<p>I touched up what I could without destroying the flow, but things would look much different if I wrote this post today.</p>
</blockquote>
<p>Thanks to everybody for the positive feedback on the first MIRE. I still have your attention, so I’ll move on to my next exercise. This one is a little more involved than the first, but bear with me - the results should be worth it.</p>
<h2 id="the-problem">The Problem</h2>
<p>I have been a big fan of Celtic knotwork for many years, and have been drawing it myself as an occasional distraction for most of that time. I don’t think I’m very good at it, but I’ve occasionally made myself proud. Heck, I’ve even designed a couple tattoos for folks, making a few bucks in the process. Any time you can profit from your hobbies is good. Any time somebody likes your work so much that they want it embedded in their skin with a sharp needle is also good.</p>
<p>My preferred technique has always been manual and therefore labor-intensive. You lay out a grid, block out your major areas, draw your knotwork paths, and then embellish a little for personality. It’s simple and repetitive, and I like it that way. There’s a meditative element to such things which can’t be ignored. Still, I’m here to write a programming exercise, not to wax eloquently about the virtues of being hunched over a sheet of paper for hours at a time.</p>
<p>Any time a geek hears the phrase &ldquo;simple and repetitive,&rdquo; the geek’s mind turns to ways of automating the task being described. Well, <em>this</em> geek’s mind does. I wonder how hard it would be to write a <a href="/card/ruby/">Ruby</a> program which could, given some dimensions by the user, create a simple knotwork panel of the desired size and then write that panel to an image file?</p>
<h2 id="finding-a-solution">Finding a Solution</h2>
<p>As it turns out, somebody else has already solved a fair chunk of the problem. Andy Sloss’s book <a href="https://www.goodreads.com/book/show/2762386-how-to-draw-celtic-knotwork">How to Draw Celtic Knotwork: A Practical Guide</a> provides a detailed overview of his approach, which essentially boils down to arranging a set of image tiles on a grid so that the end result looks like an attractive knotwork image. He’s even gone so far as to provide each of the tiles that can be used in his system.</p>
<h3 id="the-plan">The Plan</h3>
<p>This project is a little more complicated than the last MIRE, so I want to step through it a little more carefully. Actually, it’s not more complicated. It’s just that less of the work has already been done for me. Instead of jumping right into creating bitmap images on the fly, I’m going to use <a href="http://en.wikipedia.org/wiki/ASCII_art">ASCII art</a> to create my knotwork at first.</p>
<p>Let’s step through what we’ll be doing later in code. Here is a collection of image tiles arranged in a grid.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >. . . . x x x x x  x x . . . . . x x  x x x x x . . . .
. . . . x . . . .  . . x x . x x . .  . . . . x . . . .
. . . . x . . . x  . . . . x . . . .  x . . . x . . . .
. . . . x . . x .  x x . . . x . x x  . x . . x . . . .
. . . . x . . x .  . . x . . . x . .  . x . . x . . . .
. . . . . x . . x  x . . . x . . . x  x . . x . . . . .
. . . . . x . . x  . . . x . x . . x  . . . x . . . . .
. . . . . . x x .  . . x . . . x x .  . . x . . . . . .

. . . . . . x . .  . . x . . . x . .  . x x . . . . . .
. . . . . x . . .  . x . x . x . . .  x . . x . . . . .
. . . . . x . . .  x . . . x . . . x  x . . x . . . . .
. . . . x . . . x  . x . . . x . x .  . x . . x . . . .
. . . . x . . x .  . . x . . . x . .  . x . . x . . . .
. . . . x . . x .  . x . x . . . x .  . x . . x . . . .
. . . . . x . . x  x . . . x . . . x  x . . x . . . . .
. . . . . x . . x  . . . x . x . x .  . . . x . . . . .
. . . . . . x x .  . . x . . . x . .  . . x . . . . . .

. . . . . . x . .  . x x . . . x . .  . x x . . . . . .
. . . . . x . . .  x . . x . x . . .  x . . x . . . . .
. . . . . x . . x  x . . . x . . . x  x . . x . . . . .
. . . . x . . x .  . x . . . x . x .  . x . . x . . . .
. . . . x . . x .  . . x . . . x . .  . x . . x . . . .
. . . . x . . . x  x x . x . . . x x  x . . . x . . . .
. . . . x . . . .  . . . . x . . . .  . . . . x . . . .
. . . . x . . . .  . . x x . x x . .  . . . . x . . . .
. . . . x x x x x  x x . . . . . x x  x x x x x . . . .</code></pre>
</figure><p>Squish them together into one big image, and guess what? We have a knot!</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >. . . . x x x x x x x . . . . . x x x x x x x . . . .
. . . . x . . . . . . x x . x x . . . . . . x . . . .
. . . . x . . . x . . . . x . . . . x . . . x . . . .
. . . . x . . x . x x . . . x . x x . x . . x . . . .
. . . . x . . x . . . x . . . x . . . x . . x . . . .
. . . . . x . . x x . . . x . . . x x . . x . . . . .
. . . . . x . . x . . . x . x . . x . . . x . . . . .
. . . . . . x x . . . x . . . x x . . . x . . . . . .
. . . . . . x . . . . x . . . x . . . x x . . . . . .
. . . . . x . . . . x . x . x . . . x . . x . . . . .
. . . . . x . . . x . . . x . . . x x . . x . . . . .
. . . . x . . . x . x . . . x . x . . x . . x . . . .
. . . . x . . x . . . x . . . x . . . x . . x . . . .
. . . . x . . x . . x . x . . . x . . x . . x . . . .
. . . . . x . . x x . . . x . . . x x . . x . . . . .
. . . . . x . . x . . . x . x . x . . . . x . . . . .
. . . . . . x x . . . x . . . x . . . . x . . . . . .
. . . . . . x . . . x x . . . x . . . x x . . . . . .
. . . . . x . . . x . . x . x . . . x . . x . . . . .
. . . . . x . . x x . . . x . . . x x . . x . . . . .
. . . . x . . x . . x . . . x . x . . x . . x . . . .
. . . . x . . x . . . x . . . x . . . x . . x . . . .
. . . . x . . . x x x . x . . . x x x . . . x . . . .
. . . . x . . . . . . . . x . . . . . . . . x . . . .
. . . . x . . . . . . x x . x x . . . . . . x . . . .
. . . . x x x x x x x . . . . . x x x x x x x . . . .</code></pre>
</figure><p>You don’t quite see it? Well, squint a little and tilt your head a bit. Still nothing? Just bear with me. We will get to actual pictures soon, I promise.</p>
<p>Okay, let’s find a way to automate this process.</p>
<h3 id="turning-the-plan-into-code">Turning the Plan Into Code</h3>
<p>This works, doesn’t it?</p>
<p><strong><code>print-knot.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">knot</span> <span class="o">=</span><span class="s">&lt;&lt;HERE
</span></span></span><span class="line"><span class="cl"><span class="s"></span>     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">     <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">puts</span> <span class="n">knot</span></span></span></code></pre>
</figure><p>I know, &ldquo;Ha ha, very funny. You are so clever and witty. We are being sarcastic, if you didn’t guess, Mister Writer.&rdquo; I know that this is cheating, but it <em>works</em> doesn’t it? This would be good enough if all you wanted was some sort of ASCII art knot.</p>
<p>Then again, Laziness taken too far does become plain old laziness. This isn’t good enough for any of us. The idea is to be able to draw a knotwork panel of any size that we want.</p>
<p>Let’s look at the nouns we’ve used when describing the problem:</p>
<blockquote>
<p>We want to create a knotwork panel by arranging tiles on a grid, then merging them into a single image.</p>
</blockquote>
<ul>
<li>knotwork panel - <em>I threw the adjective in for a little descriptiveness</em></li>
<li>grid</li>
<li>tile</li>
<li>image</li>
</ul>
<p>I think these nouns make a good start for the class names in our program.</p>
<p><a href="http://www.zenspider.com/">Zenspider</a> once described a style of commenting classes that was like the classes were describing themselves in the first person. I don’t know why, but I really liked that concept. I’ve stuck with it in a lot of my own code.</p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># I am a single small section of a knotwork image. I know about my</span>
</span></span><span class="line"><span class="cl"><span class="c1"># dimensions, and can describe myself on a pixel-by-pixel basis.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Tile</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I am a 2-dimensional collection of tiles. I know where each of my Tiles are</span>
</span></span><span class="line"><span class="cl"><span class="n">located</span><span class="p">,</span> <span class="ow">and</span> <span class="n">can</span> <span class="n">describe</span> <span class="n">them</span> <span class="n">as</span> <span class="k">if</span> <span class="n">they</span> <span class="n">were</span> <span class="n">a</span> <span class="n">single</span> <span class="n">large</span> <span class="n">entity</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Grid</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I am a lovely Celtic knotwork panel. I know my dimensions, and can output myself</span>
</span></span><span class="line"><span class="cl"><span class="c1"># as ASCII art.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KnotworkPanel</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I know how to create a graphical representation of a KnotworkPanel</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Image</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Now I know each of the major objects in this program, and the duties that they must fill. It’s time to blaze through the highlights of writing the code. For convenience, we can put the application code and the testing code in the same file for now.</p>
<h3 id="building-a-tile">Building a Tile</h3>
<p>The simplest element of our description is the Tile. I decided that a Tile would be a two dimensional chunk of characters that would let you set or get any point in that space. Remember that this isn’t the only way we could have done things. You could also describe the lines and curves in the tile, or the colors, transparency, and whatever else the crazy kids are coming up with these days. This is my first drawing program, though, and I want to keep it as simple as I can. So I’m going with the bitmap idea. The tile images in the Sloss book are provided in different sizes. Let’s go with 9x9. It’s small and manageable without being too small to see.</p>
<blockquote>
<p><strong>2021-08-21</strong></p>
<p>Unless it&rsquo;s 2021, when you have a big monitor and old eyes.</p>
<p><em>squints and continues editing</em></p>
</blockquote>
<p><strong><code>knotwork/tile.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="no">TILE_SIZE</span> <span class="o">=</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I am a single small section of a knotwork image. I know about my</span>
</span></span><span class="line"><span class="cl"><span class="c1"># dimensions, and can describe myself on a pixel-by-pixel basis.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Tile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">str</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">TILE_SIZE</span><span class="p">)</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="no">TILE_SIZE</span><span class="p">)</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">str</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="n">set_from_string</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="vi">@pixels</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">alias</span> <span class="n">is_set?</span> <span class="n">at</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kp">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">unset</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">self</span><span class="o">.</span><span class="n">set</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="kp">nil</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">set_from_string</span><span class="p">(</span><span class="n">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="p">,</span> <span class="n">row</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">pixel</span><span class="p">,</span> <span class="n">col</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">set</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">pixel</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_s</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">str</span> <span class="o">+=</span> <span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="n">row</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">pixel</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">pixel</span> <span class="o">||=</span> <span class="s2">&#34; &#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">str</span> <span class="o">+=</span> <span class="s2">&#34;</span><span class="si">#{</span><span class="n">pixel</span><span class="si">}</span><span class="s2">|&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">str</span> <span class="o">+=</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">str</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>I&rsquo;ll write tests with the rock-solid <a href="http://docs.seattlerb.org/minitest/">Minitest</a> testing library.</p>
<p><strong><code>tests/test_tile.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;minitest/autorun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;../knotwork/tile.rb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestTile</span> <span class="o">&lt;</span> <span class="no">Minitest</span><span class="o">::</span><span class="no">Test</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">setup</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@tile</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_pixels</span>
</span></span><span class="line"><span class="cl">    <span class="n">refute</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;By default, any pixel in a Tile is blank&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;Use Tile#set(row, col) to set a pixel at coordinates (row, col)&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;A pixel (row, col) is set after Tile#set(row, col) has been called&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="vi">@tile</span><span class="o">.</span><span class="n">unset</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">refute</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;An unset pixel has no set value&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="vi">@tile</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">refute</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;Setting one pixel has no effect on other pixels in a Tile&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;Tile remembers the set status of each pixel in its confines.&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_set_from_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">source_string</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">set_from_string</span><span class="p">(</span><span class="n">source_string</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;You can use ASCII art strings to set the pixels in a Tile&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">is_set?</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="vi">@tile</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;A Tile remembers the value assigned, if given, during Tile#set(row, col, val)&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>This is — <em>2020 note: my early attempt at</em> — <a href="http://www.agiledata.org/essays/tdd.html">Test-Driven Development</a>, where you write the tests for your code as you are writing the code itself. A little <em>before</em> the code itself, actually. TDD is useful for any non-trivial programming task. You have the tests there right from the beginning to describe what your classes are supposed to be able to do. Because TDD is based on lots of tiny changes being applied rapidly over time, I decided it would be tedious to describe that process to you at each little step. Instead, we stop and take a snapshot as we get each major stage accomplished. Like that code sample up there. It’s really where I’m at right about now. See: there’s the class definition, a couple of very basic accessors, and the ability to set all the pixels of a Tile at once from a String.</p>
<p>Now that the Tile is pretty much doing everything I want it to, let’s move on to the Grid.</p>
<h3 id="putting-the-tile-in-a-grid">Putting the Tile in a Grid</h3>
<p>I want to hurry on to making pictures, so let’s rush through the Grid part.</p>
<p>That’s easy enough, actually. We only need to be able to do a few simple things with a Grid:</p>
<ul>
<li>Create it at a set size.</li>
<li>Add a Tile somewhere in the Grid.</li>
<li>Read each individual pixel of the Grid transparently.</li>
</ul>
<p>And here’s the code.</p>
<p><strong><code>knotwork/grid.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># I am an arranged collection of Tiles. I know how to add and remove</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Tiles along a 2-d grid, and can also present myself as if I were a single</span>
</span></span><span class="line"><span class="cl"><span class="c1"># large Tile.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;tile&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Grid</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@tile_size</span> <span class="o">=</span> <span class="no">TILE_SIZE</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@rows</span>      <span class="o">=</span> <span class="n">rows</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@columns</span>   <span class="o">=</span> <span class="n">columns</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span>    <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="vi">@tile_size</span><span class="p">)</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">columns</span><span class="o">*</span><span class="vi">@tile_size</span><span class="p">)</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">set_tile</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">tile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pixel_origin_x</span> <span class="o">=</span> <span class="n">row</span> <span class="o">*</span> <span class="vi">@tile_size</span>
</span></span><span class="line"><span class="cl">    <span class="n">pixel_origin_y</span> <span class="o">=</span> <span class="n">column</span> <span class="o">*</span> <span class="vi">@tile_size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="vi">@tile_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">tile_x</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">=</span> <span class="n">pixel_origin_x</span> <span class="o">+</span> <span class="n">tile_x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="vi">@tile_size</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span> <span class="o">|</span><span class="n">tile_y</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">pixel_origin_y</span> <span class="o">+</span> <span class="n">tile_y</span>
</span></span><span class="line"><span class="cl">        <span class="vi">@pixels</span><span class="o">[</span><span class="n">x</span><span class="o">][</span><span class="n">y</span><span class="o">]</span> <span class="o">=</span> <span class="n">tile</span><span class="o">.</span><span class="n">at</span> <span class="n">tile_x</span><span class="p">,</span> <span class="n">tile_y</span>
</span></span><span class="line"><span class="cl">      <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">at</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="vi">@pixels</span><span class="o">[</span><span class="n">row</span><span class="o">][</span><span class="n">column</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_s</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@pixels</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">str</span> <span class="o">+=</span> <span class="n">row</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">str</span><span class="o">.</span><span class="n">chomp</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p><strong><code>tests/test_grid.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;minitest/autorun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;../knotwork/grid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestGrid</span> <span class="o">&lt;</span> <span class="no">Minitest</span><span class="o">::</span><span class="no">Test</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">setup</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@source_string</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_simple_grid</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span> <span class="o">=</span> <span class="no">Grid</span><span class="o">.</span><span class="n">new</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">tile</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="vi">@source_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="s2">&#34;x&#34;</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;pixel_at fetches contents from pixel coordinates&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="vi">@source_string</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">to_s</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_large_grid</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span> <span class="o">=</span> <span class="no">Grid</span><span class="o">.</span><span class="n">new</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">tile1</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="vi">@source_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">tile2</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="vi">@source_string</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile1</span>
</span></span><span class="line"><span class="cl">    <span class="n">grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tile2</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="s2">&#34;x&#34;</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;pixel_at fetches from anywhere in the Grid.&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">expected_output</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">assert_equal</span> <span class="n">expected_output</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">to_s</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>There, that’s another fifteen minutes of coding done. Yes, the combination of TDD and Ruby makes it about this easy to write a program.</p>
<h3 id="using-the-grid-to-make-a-knotworkpanel">Using the Grid to Make a KnotworkPanel</h3>
<p>Things get a little more complex now, because we’re on to creating a KnotworkPanel. Every KnotworkPanel uses a specific set of predefined tiles — <em>thanks again to Andy Sloss for going to the trouble of defining them</em> — which I will store as class variables. I would probably store them in a different file if I wanted to include <em>every</em> Tile defined in Sloss’s book, but that’s more than I want to chew on today.</p>
<p>Certain Tiles must go in certain locations of the KnotworkPanel’s Grid, such as the corners and edges, and we have to remember this in our tests. Ah, let’s just cut and paste the source strings and squish them together so that they look like what we’re aiming for. That’s probably the easiest test for now.</p>
<p>For a while, my problem was that I was copying and pasting incorrectly. Don’t ask me how I pull this stuff off. I’m just special, I guess. The test results would end up spewing out &ldquo;Expected &ldquo;… a really long chain of <code>x</code> and <code>.</code> characters, &quot; but got &quot; … a really long chain of <code>x</code> and <code>.</code> characters, almost identical to the first chain. My solution? Test each row of output, that way I see exactly which line was one character off.</p>
<p><strong><code>knotwork/knotwork_panel.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;tile&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;grid&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «define-tile-maps»</span>
</span></span><span class="line"><span class="cl"><span class="c1"># «define-knotwork-panel-class»</span>
</span></span><span class="line"><span class="cl"><span class="o">----</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">define</span><span class="o">-</span><span class="n">tile</span><span class="o">-</span><span class="n">maps</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span><span class="n">source</span><span class="p">,</span><span class="n">ruby</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">----</span>
</span></span><span class="line"><span class="cl"><span class="no">NW_CORNER</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">N_EDGE</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">NE_CORNER</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">W_EDGE</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">CENTER</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">E_EDGE</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">SW_CORNER</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">S_EDGE</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="no">SE_CORNER</span> <span class="o">=</span> <span class="o">&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="no">HERE</span></span></span></code></pre>
</figure><p><strong><code>define-knotwork-panel-class</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># I am a lovely Celtic knotwork panel. I know my dimensions, and can output</span>
</span></span><span class="line"><span class="cl"><span class="c1"># myself as ASCII art.</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KnotworkPanel</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@top_left</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">NW_CORNER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@top</span>      <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">N_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@topright</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">NE_CORNER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@left</span>     <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">W_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@center</span>   <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">CENTER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@right</span>    <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">E_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@bot_left</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">SW_CORNER</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@bottom</span>   <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">S_EDGE</span>
</span></span><span class="line"><span class="cl">  <span class="vc">@@botright</span> <span class="o">=</span> <span class="no">Tile</span><span class="o">.</span><span class="n">new</span> <span class="no">SE_CORNER</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@row_size</span> <span class="o">=</span> <span class="n">rows</span> <span class="o">+</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@col_size</span> <span class="o">=</span> <span class="n">columns</span> <span class="o">+</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span> <span class="o">=</span> <span class="no">Grid</span><span class="o">.</span><span class="n">new</span> <span class="vi">@row_size</span><span class="p">,</span> <span class="vi">@col_size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Set the top row.</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="vc">@@top_left</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vc">@@topright</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="vc">@@top</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Set the center rows.</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="vc">@@left</span>
</span></span><span class="line"><span class="cl">      <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="n">i</span><span class="p">,</span> <span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vc">@@right</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">j</span><span class="o">|</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="vc">@@center</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Set the bottom row</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="vc">@@bot_left</span>
</span></span><span class="line"><span class="cl">    <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="vc">@@botright</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="o">...</span><span class="vi">@col_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">set_tile</span> <span class="vi">@row_size</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="vc">@@bottom</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_aa</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">to_s</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p><strong><code>tests/test_knotwork_panel.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;minitest/autorun&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">require</span> <span class="s2">&#34;../knotwork/knotwork_panel&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestKnotworkPanel</span> <span class="o">&lt;</span> <span class="no">Minitest</span><span class="o">::</span><span class="no">Test</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_ascii</span>
</span></span><span class="line"><span class="cl">    <span class="n">panel</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected_lines</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span><span class="o">.</span><span class="n">split</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">output_lines</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">to_aa</span><span class="o">.</span><span class="n">split</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected_lines</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">assert_equal</span> <span class="n">line</span><span class="p">,</span> <span class="n">output_lines</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;line </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2"> doesn&#39;t match&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">test_large_panels</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected</span> <span class="o">=&lt;&lt;~</span><span class="no">HERE</span><span class="o">.</span><span class="n">strip</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">      <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="n">x</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">    <span class="no">HERE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">output_lines</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_aa</span><span class="o">.</span><span class="n">split</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">line</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">assert_equal</span> <span class="n">line</span><span class="p">,</span> <span class="n">output_lines</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;line </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2"> doesn&#39;t match&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Yeah, that works. Let’s move on.</p>
<blockquote>
<p><strong>NOTE</strong></p>
<p>Wait. This is me from a few days in the future, editing this page.
KnotworkPanel’s initializer kinda bugs me. It’s fine for what it does, but how’s
the average person supposed to know that <code>KnotworkPanel.new(1,2)</code> actually
creates a KnotworkPanel with dimensions of 3x5, including the border?</p>
<p>Really, this is why you need some person to represent the customer or a user
besides yourself whenever you want to write code for other people to use. I
could change the initializer, but I really want to get the article out so the
geeks of the world can point and laugh at my mistakes.</p>
<p>For now, just remember that the dimensions sent to the initializer don’t include
the bordering tiles. So if you want a 5x5 panel, you’ll have to call
<code>KnotworkPanel.new(3, 3)</code>. Man, that’s ugly. Let’s make fixing that an exercise
at the end of the article, okay?</p>
</blockquote>
<h3 id="creating-an-image-of-the-knotworkpanel">Creating an Image of the KnotworkPanel</h3>
<p>I bet you feel really cheated by now. I’ve been going on for all this time about Celtic knotwork and drawing pictures with the computer. All you’ve seen is a bunch of dots and crosses that kind of look like a picture if you go cross-eyed for a second. You can cheer up, folks, because you’ve finished the boring part. Now we want to make a real live picture!</p>
<p>But how are we going to do it? You know that I’m <em>not</em> about to go making my own image creation library for a little project like this &ndash; or any other project, if I can help it.</p>
<p>No need. The <a href="https://rmagick.github.io/">RMagick</a> library wraps around <a href="https://www.imagemagick.org">ImageMagick</a> for all the image generating power I need today.</p>
<p><strong><code>knotwork-image-logic</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;rmagick&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kp">include</span> <span class="no">Magick</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">KnotworkPanel</span>
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">to_image</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">filename</span> <span class="o">=</span> <span class="s2">&#34;panel-</span><span class="si">#{</span><span class="vi">@row_size</span><span class="si">}</span><span class="s2">x</span><span class="si">#{</span><span class="vi">@col_size</span><span class="si">}</span><span class="s2">.png&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">max_x</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="vi">@row_size</span>
</span></span><span class="line"><span class="cl">    <span class="n">max_y</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="vi">@col_size</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">image</span> <span class="o">=</span> <span class="no">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span> <span class="p">{</span> <span class="nb">self</span><span class="o">.</span><span class="n">background_color</span> <span class="o">=</span> <span class="s2">&#34;white&#34;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="n">max_y</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">y</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="mi">0</span><span class="o">...</span><span class="n">max_x</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">x</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">pixel</span> <span class="o">=</span> <span class="vi">@grid</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pixel</span> <span class="o">==</span> <span class="s2">&#34;x&#34;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">          <span class="n">image</span><span class="o">.</span><span class="n">pixel_color</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&#34;black&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">      <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><blockquote>
<p><strong>2020-08-01</strong></p>
<p>Looks like I skipped tests for <code>Knotwork#to_image</code> as well. And wasn&rsquo;t I saying something about &ldquo;image&rdquo; being one of the nouns that should be a class? Whatever happened to that?</p>
</blockquote>
<p>Time to make an image.</p>
<p><strong><code>draw-knot.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;./knotwork/knotwork_panel.rb&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «knotwork-image-logic»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">panel</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">panel</span><span class="o">.</span><span class="n">to_image</span><span class="p">()</span></span></span></code></pre>
</figure><p>Thanks to all the work we did building Tiles and Grids and ASCII art KnotworkPanels, we only need to add a few lines to allow KnotworkPanels to create a nice black and white PNG image file. Here’s what we get::</p>
<p><figure>
    <img src="/attachments/img/2004/panel.png" alt="10x20 panel"/></figure></p>
<p>Cool, eh?</p>
<h3 id="building-knotworkpanels-of-any-size">Building KnotworkPanels of Any Size</h3>
<p>Now the program does what I want it to. But if I hand this script off to somebody else and say &ldquo;This program will make knotwork panels of any size,&rdquo; one of their first questions will be how to set the size. &ldquo;Go in and edit the code&rdquo; won’t cut it. Let’s haul out our trusty <a href="http://www.ruby-doc.org/stdlib/libdoc/optparse/rdoc/classes/OptionParser.html">OptParse</a> library again.</p>
<p><strong><code>main-with-option-parser</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span>
</span></span><span class="line"><span class="cl">  <span class="n">rows</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">columns</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">opts</span> <span class="o">=</span> <span class="no">OptionParser</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">opts</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">banner</span> <span class="o">=</span> <span class="s2">&#34;Usage </span><span class="si">#{</span><span class="vg">$0</span><span class="si">}</span><span class="s2"> |opts|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">separator</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">separator</span> <span class="s2">&#34;Specific Options&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&#34;-r&#34;</span><span class="p">,</span> <span class="s2">&#34;--rows [ROWS]&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Number of rows for this panel (default 1)&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">rows</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">to_i</span>
</span></span><span class="line"><span class="cl">      <span class="n">columns</span> <span class="o">=</span> <span class="n">rows</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s2">&#34;-c&#34;</span><span class="p">,</span> <span class="s2">&#34;--columns [COLUMNS]&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;Number of columns for this panel (default ROWS)&#34;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">c</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">columns</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">to_i</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">opts</span><span class="o">.</span><span class="n">on_tail</span><span class="p">(</span><span class="s2">&#34;-h&#34;</span><span class="p">,</span> <span class="s2">&#34;--help&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="s2">&#34;Show this message&#34;</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="nb">puts</span> <span class="n">opts</span>
</span></span><span class="line"><span class="cl">      <span class="nb">exit</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">opts</span><span class="o">.</span><span class="n">parse!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">panel</span> <span class="o">=</span> <span class="no">KnotworkPanel</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">panel</span><span class="o">.</span><span class="n">to_image</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span></span></span></code></pre>
</figure><p>Running it with the default should result in a 3x3 panel:</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby knotworkpanel.rb</code></pre>
</figure><p><figure>
    <img src="/attachments/img/2004/panel-3x3.png" alt="3x3 panel"/></figure></p>
<p>Setting <code>rows</code> to 2 results in a 4x4 panel.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby knotworkpanel.rb --rows 2</code></pre>
</figure><p><figure>
    <img src="/attachments/img/2004/panel-4x4.png" alt="4x4 panel"/></figure></p>
<blockquote>
<p><strong>NOTE</strong></p>
<p>Me from the immediate future says &ldquo;See? This is what I was talking about. You say
&lsquo;2 rows&rsquo;, and you get a 4x4 square? How do you think people are going to
react? Man, I need more coffee.&rdquo;</p>
</blockquote>
<p>Ignoring me from the future for today, let’s see what happens when we try to make a nice <em>big</em> KnotworkPanel.</p>
<figure class="highlight">
  <pre tabindex="0"
    ><code class="language-" data-lang=""
      >$ ruby knotworkpanel.rb --rows 98 --columns 73</code></pre>
</figure><p>Hmm … took a few seconds this time. If I cared about performance, I might go in and see where this could be tightened up. I don’t care about performance today, though. I care about results. And the results aren’t too bad.</p>
<blockquote>
<p><strong>2021-08-21</strong></p>
<p>oh god my eyes. The knots are so tiny on a modern monitor, and there are so   many of them. I pulled the link to the big panel out of the main text so it won&rsquo;t catch anybody unawares. If you have any visually-triggered issues maybe don&rsquo;t click.</p>
<p><a href="attachments/img/2004/panel-100x75.png">you have been warned</a></p>
</blockquote>
<h3 id="cleaning-up">Cleaning Up</h3>
<p>Okay, it’s done! That is to say, it does all the things I want it to for now. There’s a <em>lot</em> more stuff that I would like to do with this program, but it’s important to know when to stop and take a breath. Let’s just go back and clean up the code a little bit. Not actually change any functionality or user interface, so Me From The Future is just going to have to wait. I only want to make it easier to read the code that I have already written.</p>
<p><strong><code>knotwork.rb</code></strong></p>
<figure class="highlight">
  <pre tabindex="0" class="chroma"
    ><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="nb">require</span> <span class="s1">&#39;./knotwork/knotwork_panel.rb&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «knotwork-image-logic»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># «main-with-option-parser»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">main</span></span></span></code></pre>
</figure><h2 id="conclusion">Conclusion</h2>
<p>Okay, so that’s about it. We’ve gone from an idea to a program that creates png formatted images of Celtic-style knotwork panels. Not bad at all. There are a lot of other things we could do with this program, though.</p>
<p>Here are a few ideas:</p>
<ul>
<li>Come up with some good ideas for unit testing the image generation code. Then send them to me :smile:</li>
<li>Antialias the lines for a smoother effect.</li>
<li>Add color.</li>
<li>Incorporate the rest of the patterns detailed in the Andy Sloss book.</li>
<li>Add the ability to make complex panels.</li>
<li>Add the ability to scale pattern panels to any size.</li>
<li>Make Me From The Future happy by fine-tuning the KnotworkPanel initializer and/or the OptParse options so that the user gets a 3x3 panel when they request a 3x3 panel. Oh, but what happens when the user requests a 1x1 panel? I guess you’ll have to figure that out.</li>
<li>Done already? Andy Sloss also wrote a book using similar techniques for drawing key patterns. Go write that program, and merge it with this one for a lean, mean, Celtic-art producing machine.</li>
</ul>
]]></content:encoded>
</item>
</channel>
</rss>
